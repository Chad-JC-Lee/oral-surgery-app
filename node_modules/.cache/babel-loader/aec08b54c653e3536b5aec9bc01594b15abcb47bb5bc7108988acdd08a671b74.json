{"ast":null,"code":"import React,{useState,useCallback}from'react';import styled,{keyframes}from'styled-components';import{Activity,Bed,Droplets,ArrowLeft,Home}from'lucide-react';import googleAiService from'./services/googleAiService';import ApiKeySetup from'./components/ApiKeySetup';// 動畫定義\nimport{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const fadeIn=keyframes`\n  from {\n    opacity: 0;\n    transform: translateY(20px);\n  }\n  to {\n    opacity: 1;\n    transform: translateY(0);\n  }\n`;const slideIn=keyframes`\n  from {\n    opacity: 0;\n    transform: translateX(-20px);\n  }\n  to {\n    opacity: 1;\n    transform: translateX(0);\n  }\n`;const pulse=keyframes`\n  0%, 100% {\n    opacity: 1;\n  }\n  50% {\n    opacity: 0.5;\n  }\n`;const bounce=keyframes`\n  0%, 20%, 53%, 80%, 100% {\n    transform: translate3d(0,0,0);\n  }\n  40%, 43% {\n    transform: translate3d(0, -8px, 0);\n  }\n  70% {\n    transform: translate3d(0, -4px, 0);\n  }\n  90% {\n    transform: translate3d(0, -2px, 0);\n  }\n`;const AppContainer=styled.div`\n  max-width: 900px;\n  margin: 0 auto;\n  padding: 20px;\n  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n  min-height: 100vh;\n  color: white;\n`;const ContentCard=styled.div`\n  background: white;\n  border-radius: 20px;\n  padding: 30px;\n  box-shadow: 0 10px 30px rgba(0,0,0,0.2);\n  color: #2c3e50;\n  animation: ${fadeIn} 0.6s ease-out;\n`;const Header=styled.div`\n  text-align: center;\n  margin-bottom: 30px;\n`;const Title=styled.h1`\n  color: white;\n  margin-bottom: 10px;\n  font-size: 2.5rem;\n  font-weight: 700;\n`;const Subtitle=styled.p`\n  color: rgba(255,255,255,0.9);\n  font-size: 1.1rem;\n  margin: 0;\n`;const NavigationBar=styled.div`\n  display: flex;\n  align-items: center;\n  margin-bottom: 20px;\n  gap: 15px;\n`;const NavButton=styled.button`\n  background: rgba(255,255,255,0.2);\n  border: none;\n  color: white;\n  padding: 10px 15px;\n  border-radius: 25px;\n  cursor: pointer;\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  font-size: 1rem;\n  transition: all 0.3s ease;\n  \n  &:hover {\n    background: rgba(255,255,255,0.3);\n    transform: translateY(-2px);\n  }\n`;const StepIndicator=styled.div`\n  display: flex;\n  justify-content: center;\n  margin-bottom: 30px;\n`;const Step=styled.div`\n  display: flex;\n  align-items: center;\n  color: ${props=>props.active?'white':'rgba(255,255,255,0.6)'};\n  font-weight: ${props=>props.active?'bold':'normal'};\n  \n  &:not(:last-child)::after {\n    content: '→';\n    margin: 0 15px;\n    color: rgba(255,255,255,0.6);\n  }\n`;const SymptomGrid=styled.div`\n  display: grid;\n  grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));\n  gap: 20px;\n  margin-bottom: 30px;\n`;const SymptomCard=styled.div`\n  background: ${props=>props.selected?'#667eea':'white'};\n  color: ${props=>props.selected?'white':'#2c3e50'};\n  padding: 25px;\n  border-radius: 15px;\n  border: 2px solid ${props=>props.selected?'#667eea':'#e0e0e0'};\n  cursor: pointer;\n  transition: all 0.3s ease;\n  text-align: center;\n  animation: ${fadeIn} 0.6s ease-out;\n  \n  &:hover {\n    transform: translateY(-5px);\n    box-shadow: 0 10px 25px rgba(0,0,0,0.15);\n  }\n`;const SymptomIcon=styled.div`\n  margin-bottom: 15px;\n  color: #667eea;\n`;const ActionButton=styled.button`\n  background: ${props=>props.primary?'#667eea':'rgba(102, 126, 234, 0.1)'};\n  color: ${props=>props.primary?'white':'#667eea'};\n  border: 2px solid #667eea;\n  padding: 12px 24px;\n  border-radius: 25px;\n  cursor: pointer;\n  font-size: 1rem;\n  font-weight: 600;\n  transition: all 0.3s ease;\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  \n  &:hover {\n    background: ${props=>props.primary?'#5a6fd8':'rgba(102, 126, 234, 0.2)'};\n    transform: translateY(-2px);\n  }\n`;const ButtonContainer=styled.div`\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-top: 30px;\n  gap: 15px;\n`;const SummaryContainer=styled.div`\n  background: #f8f9fa;\n  border-radius: 15px;\n  padding: 25px;\n  margin: 20px 0;\n  animation: ${fadeIn} 0.6s ease-out;\n`;const SummaryItem=styled.div`\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 10px 0;\n  border-bottom: 1px solid #e9ecef;\n  \n  &:last-child {\n    border-bottom: none;\n  }\n`;const SummaryLabel=styled.span`\n  font-weight: 600;\n  color: #495057;\n`;const SummaryValue=styled.span`\n  color: #667eea;\n  font-weight: 500;\n`;// 載入動畫組件\nconst LoadingContainer=styled.div`\n  text-align: center;\n  padding: 60px 40px;\n  animation: ${fadeIn} 0.5s ease-out;\n`;const LoadingSpinner=styled.div`\n  display: inline-block;\n  width: 60px;\n  height: 60px;\n  border: 4px solid #f3f3f3;\n  border-top: 4px solid #667eea;\n  border-radius: 50%;\n  animation: spin 1s linear infinite;\n  \n  @keyframes spin {\n    0% { transform: rotate(0deg); }\n    100% { transform: rotate(360deg); }\n  }\n`;const LoadingText=styled.p`\n  margin-top: 20px;\n  font-size: 1.1rem;\n  color: #2c3e50;\n  animation: ${pulse} 2s ease-in-out infinite;\n`;const LoadingDots=styled.div`\n  display: flex;\n  justify-content: center;\n  gap: 4px;\n  margin-top: 10px;\n`;const Dot=styled.div`\n  width: 8px;\n  height: 8px;\n  border-radius: 50%;\n  background: #667eea;\n  animation: ${bounce} 1.4s ease-in-out infinite both;\n  animation-delay: ${props=>props.delay}s;\n`;// AI選項容器\nconst AiOptionsContainer=styled.div`\n  animation: ${fadeIn} 0.6s ease-out;\n`;const OptionCard=styled.button`\n  padding: 20px;\n  border: 2px solid #e0e0e0;\n  border-radius: 15px;\n  background: ${props=>props.selected?'#667eea':'white'};\n  color: ${props=>props.selected?'white':'#2c3e50'};\n  cursor: pointer;\n  font-size: 1rem;\n  transition: all 0.3s ease;\n  text-align: left;\n  margin-bottom: 15px;\n  animation: ${slideIn} 0.6s ease-out;\n  animation-delay: ${props=>props.delay}s;\n  \n  &:hover {\n    transform: translateY(-2px);\n    box-shadow: 0 8px 20px rgba(0,0,0,0.1);\n    border-color: #667eea;\n  }\n  \n  &:active {\n    transform: translateY(0);\n  }\n`;const OptionTitle=styled.h3`\n  margin: 0 0 10px 0;\n  font-size: 1.2rem;\n  font-weight: 600;\n`;const OptionDescription=styled.p`\n  margin: 0;\n  opacity: 0.8;\n  line-height: 1.5;\n`;// 錯誤容器\nconst ErrorContainer=styled.div`\n  text-align: center;\n  padding: 40px;\n  animation: ${fadeIn} 0.5s ease-out;\n`;const ErrorMessage=styled.p`\n  color: ${props=>props.isServiceUnavailable?'#856404':'#e74c3c'};\n  font-size: 1.1rem;\n  margin-bottom: 20px;\n  background: ${props=>props.isServiceUnavailable?'#fff3cd':'#f8d7da'};\n  border: 1px solid ${props=>props.isServiceUnavailable?'#ffeaa7':'#f5c6cb'};\n  padding: 15px;\n  border-radius: 8px;\n`;const RetryButton=styled(ActionButton)`\n  background: #28a745;\n  color: white;\n  border-color: #28a745;\n  \n  &:hover {\n    background: #218838;\n  }\n`;// 進度指示器\nconst ProgressIndicator=styled.div`\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  margin-bottom: 20px;\n  gap: 10px;\n`;const ProgressStep=styled.div`\n  width: 12px;\n  height: 12px;\n  border-radius: 50%;\n  background: ${props=>props.active?'#667eea':'#e0e0e0'};\n  transition: all 0.3s ease;\n`;const ProgressText=styled.span`\n  font-size: 0.9rem;\n  color: ${props=>props.active?'#667eea':'#666'};\n  font-weight: ${props=>props.active?'bold':'normal'};\n`;function App(){var _symptoms$find3;const[selectedSymptom,setSelectedSymptom]=useState(null);const[aiOptions,setAiOptions]=useState([]);const[selectedOption,setSelectedOption]=useState(null);const[subOptions,setSubOptions]=useState([]);const[selectedSubOption,setSelectedSubOption]=useState(null);const[detailedOptions,setDetailedOptions]=useState([]);const[selectedDetailedOption,setSelectedDetailedOption]=useState(null);const[loading,setLoading]=useState(false);const[error,setError]=useState({message:'',isServiceUnavailable:false});const[showAiSummary,setShowAiSummary]=useState(false);const[currentStep,setCurrentStep]=useState(1);const[apiCallCount,setApiCallCount]=useState(0);// 添加API調用計數器\nconst[isProcessing,setIsProcessing]=useState(false);// 添加防抖機制\n// 多維度評估狀態\nconst[dimensionSelections,setDimensionSelections]=useState({});const[dimensionData,setDimensionData]=useState(null);const symptoms=[{id:'pain',title:'疼痛',description:'評估疼痛程度、位置和性質',icon:Activity},{id:'sleep',title:'睡眠困難',description:'評估睡眠質量和相關問題',icon:Bed},{id:'tube',title:'管路問題',description:'評估各種管路的狀況',icon:Droplets},{id:'excretion',title:'排泄問題',description:'評估大小便相關問題',icon:Droplets}];// 使用 useCallback 來避免不必要的重新渲染\nconst fetchAiOptions=useCallback(async function(symptomId){let isSubLevel=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;let parentOption=arguments.length>2&&arguments[2]!==undefined?arguments[2]:null;let step=arguments.length>3&&arguments[3]!==undefined?arguments[3]:null;// 第一層使用預設選項，不需要API調用\nif(!isSubLevel){setLoading(false);setError({message:'',isServiceUnavailable:false});setAiOptions(getDefaultOptions(symptomId));return;}// 限制API調用次數，防止過載\nif(apiCallCount>=10){console.warn('API調用次數過多，使用預設選項');setSubOptions(getDefaultSubOptions(symptomId,parentOption));setLoading(false);return;}setLoading(true);setError({message:'',isServiceUnavailable:false});setApiCallCount(prev=>prev+1);try{var _symptoms$find;const symptomName=(_symptoms$find=symptoms.find(s=>s.id===symptomId))===null||_symptoms$find===void 0?void 0:_symptoms$find.title;// 如果是多維度評估的結果，構建綜合描述\nlet combinedDescription='';if(parentOption==='combined'&&dimensionData&&dimensionSelections){const descriptions=[];dimensionData.dimensions.forEach(dimension=>{const selectedOptionId=dimensionSelections[dimension.id];// 特殊處理疼痛程度（VAS）\nif(symptomId==='pain'&&dimension.id==='pain_level'){if(selectedOptionId!==undefined){descriptions.push(`${dimension.title}: ${selectedOptionId}/10分`);}}else{// 處理其他維度\nconst selectedOption=dimension.options.find(opt=>opt.id===selectedOptionId);if(selectedOption){descriptions.push(`${dimension.title}: ${selectedOption.title}`);}}});combinedDescription=descriptions.join('; ');}const data=await googleAiService.generateSymptomOptions(symptomId,symptomName,isSubLevel,parentOption,combinedDescription);const targetStep=step||currentStep;if(targetStep===2){setSubOptions(data.options||[]);setSelectedSubOption(null);}else if(targetStep===3){setDetailedOptions(data.options||[]);setSelectedDetailedOption(null);}}catch(err){console.error('Google AI服務失敗:',err);// 確保錯誤對象有正確的結構\nconst errorMessage=err&&err.message?err.message:'未知錯誤';// 檢查是否是服務不可用錯誤\nif(errorMessage.includes('503')||errorMessage.includes('overloaded')||errorMessage.includes('UNAVAILABLE')){setError({message:'AI服務暫時不可用，正在使用預設選項...',isServiceUnavailable:true});// 延遲一下讓用戶看到錯誤信息\nsetTimeout(()=>{const targetStep=step||currentStep;if(targetStep===2){setSubOptions(getDefaultSubOptions(symptomId,parentOption));}else if(targetStep===3){setDetailedOptions(getDefaultSubOptions(symptomId,parentOption));}setError({message:'',isServiceUnavailable:false});},2000);}else{setError({message:errorMessage,isServiceUnavailable:false});// 如果Google AI服務失敗，使用預設選項\nconst targetStep=step||currentStep;if(targetStep===2){setSubOptions(getDefaultSubOptions(symptomId,parentOption));}else if(targetStep===3){setDetailedOptions(getDefaultSubOptions(symptomId,parentOption));}}}finally{setLoading(false);}},[apiCallCount,symptoms,dimensionData,dimensionSelections,currentStep]);const getDefaultOptions=symptomId=>{const defaultOptions={pain:{dimensions:[{id:'pain_level',title:'疼痛程度',options:[]// 使用VAS滑動條，不需要選項\n},{id:'pain_location',title:'疼痛位置',options:[{id:'incision',title:'手術切口',description:''},{id:'tooth',title:'牙齒',description:''},{id:'throat',title:'喉嚨',description:''},{id:'head',title:'頭部',description:''},{id:'neck',title:'頸部',description:''},{id:'chest',title:'胸部',description:''}]},{id:'pain_nature',title:'疼痛性質',options:[{id:'dull',title:'鈍痛',description:''},{id:'sharp',title:'刺痛',description:''},{id:'throbbing',title:'跳痛',description:''},{id:'burning',title:'灼痛',description:''},{id:'aching',title:'隱痛',description:''},{id:'cramping',title:'痙攣痛',description:''}]},{id:'pain_pattern',title:'疼痛模式',options:[{id:'continuous',title:'持續性',description:''},{id:'intermittent',title:'間歇性',description:''},{id:'activity_related',title:'活動相關',description:''},{id:'position_related',title:'姿勢相關',description:''},{id:'time_related',title:'時間相關',description:''}]}]},sleep:{dimensions:[{id:'sleep_problems',title:'睡眠問題',options:[{id:'difficulty_falling',title:'入睡困難',description:''},{id:'frequent_waking',title:'容易醒來',description:''},{id:'early_waking',title:'早醒',description:''}]},{id:'sleep_duration',title:'睡眠時長',options:[{id:'less_than_4',title:'少於4小時',description:''},{id:'4_to_6',title:'4-6小時',description:''},{id:'6_to_8',title:'6-8小時',description:''},{id:'more_than_8',title:'8小時以上',description:''}]},{id:'sleep_disturbance',title:'干擾因素',options:[{id:'pain',title:'疼痛',description:''},{id:'anxiety',title:'焦慮',description:''},{id:'environment',title:'環境',description:''},{id:'breathing',title:'呼吸問題',description:''},{id:'none',title:'無干擾',description:''}]}]},tube:{dimensions:[{id:'tube_type',title:'哪一管路問題',options:[{id:'nasogastric',title:'鼻胃管',description:''},{id:'drainage',title:'引流管',description:''},{id:'tracheostomy',title:'氣切管',description:''},{id:'catheter',title:'導尿管',description:''}]},{id:'tube_abnormal',title:'異常情形',options:[{id:'bleeding',title:'滲血',description:''},{id:'discharge',title:'分泌物變多',description:''},{id:'loose',title:'管路鬆動',description:''},{id:'pain',title:'疼痛',description:''}]},{id:'tube_color',title:'顏色變化',options:[{id:'normal',title:'正常',description:''},{id:'yellow',title:'發黃',description:''},{id:'green',title:'發綠',description:''},{id:'red',title:'發紅',description:''}]}]},excretion:{dimensions:[{id:'urination_status',title:'小便狀況',options:[{id:'normal',title:'正常',description:''},{id:'difficulty',title:'排尿困難',description:''},{id:'frequency_change',title:'頻率改變',description:''},{id:'incontinence',title:'尿失禁',description:''},{id:'blood_urine',title:'血尿',description:''}]},{id:'bowel_status',title:'大便狀況',options:[{id:'normal',title:'正常',description:''},{id:'constipation',title:'便秘',description:''},{id:'diarrhea',title:'腹瀉',description:''},{id:'blood_stool',title:'血便',description:''},{id:'irregular',title:'不規律',description:''}]},{id:'excretion_timing',title:'排泄時間',options:[{id:'normal_timing',title:'正常時間',description:''},{id:'frequent',title:'頻繁',description:''},{id:'infrequent',title:'稀少',description:''},{id:'nocturnal',title:'夜間頻繁',description:''}]}]}};return defaultOptions[symptomId]||{dimensions:[]};};const getDefaultSubOptions=(symptomId,parentOption)=>{var _defaultSubOptions$sy;const defaultSubOptions={pain:{mild_pain:[{id:'dull_pain',title:'鈍痛',description:'持續性的鈍痛，疼痛性質較為溫和，可以忍受'},{id:'aching_pain',title:'隱痛',description:'深層的隱痛，疼痛位置不明確，可能為內臟痛'},{id:'soreness',title:'酸痛',description:'肌肉酸痛感，可能因手術後活動減少造成'}],moderate_pain:[{id:'throbbing_pain',title:'跳痛',description:'有節奏的跳痛，可能與心跳同步，疼痛強度會變化'},{id:'distending_pain',title:'脹痛',description:'脹脹的疼痛感，可能因局部腫脹或壓力造成'},{id:'burning_pain',title:'灼痛',description:'火燒般的疼痛，可能因神經受損或炎症造成'}],severe_pain:[{id:'sharp_pain',title:'刺痛',description:'尖銳的刺痛，疼痛強度很高，難以忍受'},{id:'tearing_pain',title:'撕裂痛',description:'如撕裂般的劇烈疼痛，需要立即醫療處理'},{id:'cramping_pain',title:'痙攣痛',description:'間歇性的痙攣痛，疼痛強度會突然變化'}],localized_pain:[{id:'incision_pain',title:'切口疼痛',description:'手術切口部位的疼痛，可能因縫線或癒合過程造成'},{id:'tooth_pain',title:'牙齒疼痛',description:'牙齒或牙齦的疼痛，可能因手術影響口腔'},{id:'throat_pain',title:'喉嚨疼痛',description:'喉嚨部位的疼痛，可能因插管或手術影響'}],radiating_pain:[{id:'head_radiation',title:'向頭部放射',description:'疼痛向頭部放射，可能因神經受壓或炎症'},{id:'neck_radiation',title:'向頸部放射',description:'疼痛向頸部放射，可能影響轉頭和活動'},{id:'shoulder_radiation',title:'向肩部放射',description:'疼痛向肩部放射，可能影響上肢活動'}],intermittent_pain:[{id:'activity_related',title:'活動相關',description:'疼痛與特定活動相關，如說話、進食、轉頭等'},{id:'position_related',title:'姿勢相關',description:'疼痛與身體姿勢相關，改變姿勢可緩解'},{id:'time_related',title:'時間相關',description:'疼痛在特定時間加重，如夜間或進食後'}]},sleep:{difficulty_falling:[{id:'pain_insomnia',title:'疼痛失眠',description:'因手術部位疼痛而無法入睡，需要止痛藥物'},{id:'anxiety_insomnia',title:'焦慮失眠',description:'因手術後焦慮和擔心而無法放鬆入睡'},{id:'environment_insomnia',title:'環境失眠',description:'因醫院環境、噪音或光線而無法入睡'}],frequent_waking:[{id:'pain_waking',title:'疼痛醒來',description:'因疼痛而夜間醒來，需要調整姿勢或服藥'},{id:'breathing_waking',title:'呼吸問題醒來',description:'因呼吸困難或鼻塞而夜間醒來'},{id:'urination_waking',title:'夜尿頻繁',description:'因夜間頻繁排尿而影響睡眠連續性'}],early_waking:[{id:'early_awake',title:'早醒',description:'比平時早醒，無法再入睡'},{id:'light_sleep_early',title:'淺眠早醒',description:'睡眠很淺，容易早醒'},{id:'anxiety_early',title:'焦慮早醒',description:'因焦慮而早醒，無法繼續睡眠'}],less_than_4:[{id:'severe_insomnia',title:'嚴重失眠',description:'每晚睡眠少於4小時，嚴重影響日間功能'},{id:'pain_short_sleep',title:'疼痛影響',description:'因疼痛而無法長時間睡眠'},{id:'anxiety_short_sleep',title:'焦慮影響',description:'因焦慮而無法長時間睡眠'}],'4_to_6':[{id:'moderate_insomnia',title:'中度失眠',description:'每晚睡眠4-6小時，略顯不足'},{id:'partial_rest',title:'部分休息',description:'睡眠時間勉強夠用，但品質不佳'},{id:'interrupted_sleep',title:'間斷睡眠',description:'睡眠時間被多次打斷'}],'6_to_8':[{id:'adequate_sleep',title:'充足睡眠',description:'每晚睡眠6-8小時，基本充足'},{id:'normal_duration',title:'正常時長',description:'睡眠時間在正常範圍內'},{id:'good_quality',title:'品質良好',description:'睡眠時間充足且品質良好'}],more_than_8:[{id:'excessive_sleep',title:'過度睡眠',description:'每晚睡眠超過8小時，可能因疲勞或藥物'},{id:'recovery_sleep',title:'恢復睡眠',description:'因手術後需要更多休息時間'},{id:'medication_sleep',title:'藥物影響',description:'因藥物作用而睡眠時間延長'}],pain:[{id:'surgical_pain',title:'手術疼痛',description:'手術部位疼痛影響睡眠'},{id:'position_pain',title:'姿勢疼痛',description:'因疼痛而無法找到舒適睡眠姿勢'},{id:'medication_pain',title:'藥物依賴',description:'需要止痛藥物才能入睡'}],anxiety:[{id:'surgery_worry',title:'手術擔心',description:'因擔心手術結果而焦慮'},{id:'future_worry',title:'未來擔心',description:'因擔心未來治療而無法放鬆'},{id:'stress_sleep',title:'壓力失眠',description:'因手術後各種壓力而無法放鬆'}],environment:[{id:'hospital_noise',title:'醫院噪音',description:'醫院環境噪音影響睡眠'},{id:'bright_light',title:'光線過亮',description:'病房光線過亮影響睡眠'},{id:'uncomfortable_bed',title:'床鋪不適',description:'病床不舒適影響睡眠'}],breathing:[{id:'nasal_obstruction',title:'鼻塞',description:'因手術後鼻塞而影響呼吸'},{id:'throat_discomfort',title:'喉嚨不適',description:'因喉嚨不適而影響呼吸'},{id:'shortness_breath',title:'呼吸困難',description:'因呼吸困難而無法安睡'}]},tube:{normal_condition:[{id:'removal_question',title:'移除時間',description:'想了解何時可以安全移除管路'},{id:'care_instruction',title:'護理指導',description:'需要詳細的管路護理指導和注意事項'},{id:'comfort_improvement',title:'舒適改善',description:'希望改善管路舒適度，減少異物感'}],mild_discomfort:[{id:'tight_fixation',title:'固定過緊',description:'管路固定過緊造成局部壓迫和不適'},{id:'foreign_body',title:'異物感',description:'明顯感覺到管路的存在，有異物感'},{id:'mild_pressure',title:'輕微壓迫',description:'管路造成輕微壓迫感，但不影響功能'}],serious_issue:[{id:'bleeding',title:'滲血',description:'管路周圍有滲血，需要立即處理'},{id:'infection',title:'感染徵象',description:'管路周圍有紅腫、發熱等感染徵象'},{id:'displacement',title:'管路移位',description:'管路位置發生改變，可能影響功能'}],irritation:[{id:'skin_redness',title:'皮膚發紅',description:'管路周圍皮膚發紅，可能有過敏反應'},{id:'itching',title:'瘙癢',description:'管路周圍皮膚瘙癢，可能因摩擦或過敏'},{id:'rash',title:'皮疹',description:'管路周圍出現皮疹，需要皮膚科評估'}],pressure_discomfort:[{id:'circulation_issue',title:'循環問題',description:'管路壓迫影響局部血液循環'},{id:'swelling',title:'腫脹',description:'管路周圍出現腫脹，可能因壓迫造成'},{id:'numbness',title:'麻木',description:'管路周圍出現麻木感，可能因神經受壓'}],movement_restriction:[{id:'speaking_difficulty',title:'說話困難',description:'管路影響說話功能，發音不清'},{id:'eating_difficulty',title:'進食困難',description:'管路影響進食功能，咀嚼或吞嚥困難'},{id:'head_movement',title:'頭部活動受限',description:'管路影響頭部轉動等活動'}]},excretion:{urination_issue:[{id:'difficulty_urinating',title:'排尿困難',description:'無法正常排尿，需要用力或等待'},{id:'incontinence',title:'尿失禁',description:'無法控制排尿，可能因手術影響神經'},{id:'frequency_change',title:'頻率改變',description:'排尿頻率異常，可能增加或減少'}],bowel_issue:[{id:'constipation',title:'便秘',description:'排便困難或次數減少，可能因藥物或活動減少'},{id:'diarrhea',title:'腹瀉',description:'頻繁的稀便，可能因藥物或感染造成'},{id:'blood_stool',title:'血便',description:'大便中帶血，需要立即就醫檢查'}],no_issue:[{id:'normal_function',title:'功能正常',description:'大小便功能完全正常，無異常症狀'},{id:'slight_change',title:'輕微變化',description:'有輕微的變化但無大礙，屬於正常範圍'},{id:'monitoring',title:'持續觀察',description:'需要持續觀察變化，目前無明顯異常'}],frequency_change:[{id:'increased_frequency',title:'頻率增加',description:'排尿或排便頻率明顯增加'},{id:'decreased_frequency',title:'頻率減少',description:'排尿或排便頻率明顯減少'},{id:'irregular_pattern',title:'不規律',description:'排尿或排便模式不規律，無法預測'}],incontinence:[{id:'urinary_incontinence',title:'尿失禁',description:'無法控制排尿，可能因手術影響'},{id:'fecal_incontinence',title:'大便失禁',description:'無法控制排便，可能因手術影響'},{id:'mixed_incontinence',title:'混合失禁',description:'同時存在尿失禁和大便失禁'}],blood_in_stool:[{id:'blood_urine',title:'血尿',description:'小便中帶血，需要立即就醫檢查'},{id:'blood_stool_only',title:'血便',description:'大便中帶血，需要立即就醫檢查'},{id:'both_blood',title:'血尿血便',description:'同時存在血尿和血便，需要緊急就醫'}]}};return((_defaultSubOptions$sy=defaultSubOptions[symptomId])===null||_defaultSubOptions$sy===void 0?void 0:_defaultSubOptions$sy[parentOption])||[];};const handleSymptomSelect=useCallback(async symptomId=>{setSelectedSymptom(symptomId);setShowAiSummary(false);setSelectedOption(null);setSelectedSubOption(null);setSubOptions([]);setCurrentStep(1);setError({message:'',isServiceUnavailable:false});// 初始化多維度評估\nconst symptomData=getDefaultOptions(symptomId);setDimensionData(symptomData);setDimensionSelections({});},[]);const handleDimensionSelect=useCallback((dimensionId,optionId)=>{setDimensionSelections(prev=>({...prev,[dimensionId]:optionId}));},[]);const handleOptionSelect=useCallback(async optionId=>{setSelectedOption(optionId);setCurrentStep(2);setError({message:'',isServiceUnavailable:false});// 調用AI API獲取第二層選項\nawait fetchAiOptions(selectedSymptom,true,optionId,2);},[fetchAiOptions,selectedSymptom]);const handleSubOptionSelect=useCallback(async subOptionId=>{setSelectedSubOption(subOptionId);setError({message:'',isServiceUnavailable:false});// 設置當前步驟為3並調用API\nsetCurrentStep(3);await fetchAiOptions(selectedSymptom,true,subOptionId,3);},[fetchAiOptions,selectedSymptom]);const handleDetailedOptionSelect=useCallback(detailedOptionId=>{setSelectedDetailedOption(detailedOptionId);setShowAiSummary(true);},[]);const handleBack=useCallback(()=>{if(currentStep===3){// 回到第二層\nsetCurrentStep(2);setSelectedDetailedOption(null);setDetailedOptions([]);setShowAiSummary(false);}else if(currentStep===2){// 回到第一層\nsetCurrentStep(1);setSelectedSubOption(null);setSubOptions([]);setShowAiSummary(false);}else{// 回到主選單\nsetSelectedSymptom(null);setShowAiSummary(false);setAiOptions([]);setSelectedOption(null);setSelectedSubOption(null);setSubOptions([]);setSelectedDetailedOption(null);setDetailedOptions([]);setCurrentStep(1);setLoading(false);setError({message:'',isServiceUnavailable:false});setApiCallCount(0);// 重置API調用計數器\nsetDimensionSelections({});setDimensionData(null);}},[currentStep]);const handleReset=useCallback(()=>{setSelectedSymptom(null);setShowAiSummary(false);setAiOptions([]);setSelectedOption(null);setSelectedSubOption(null);setSubOptions([]);setSelectedDetailedOption(null);setDetailedOptions([]);setCurrentStep(1);setLoading(false);setError({message:'',isServiceUnavailable:false});setApiCallCount(0);// 重置API調用計數器\nsetDimensionSelections({});setDimensionData(null);},[]);// 添加防抖機制，避免快速點擊\nconst debouncedSymptomSelect=useCallback(async symptomId=>{if(isProcessing)return;setIsProcessing(true);await handleSymptomSelect(symptomId);setIsProcessing(false);},[handleSymptomSelect,isProcessing]);const renderAiOptions=()=>{if(loading){return/*#__PURE__*/_jsxs(LoadingContainer,{children:[/*#__PURE__*/_jsx(LoadingSpinner,{}),/*#__PURE__*/_jsx(LoadingText,{children:currentStep===1?'載入標準化評估選項...':'AI正在根據您的評估結果生成深入問題...'}),/*#__PURE__*/_jsxs(LoadingDots,{children:[/*#__PURE__*/_jsx(Dot,{delay:0}),/*#__PURE__*/_jsx(Dot,{delay:0.2}),/*#__PURE__*/_jsx(Dot,{delay:0.4})]}),apiCallCount>0&&currentStep===2&&/*#__PURE__*/_jsxs(\"div\",{style:{marginTop:'10px',fontSize:'0.9rem',color:'#666'},children:[\"AI\\u5206\\u6790\\u6B21\\u6578: \",apiCallCount,\"/10\"]})]});}if(error&&error.message){return/*#__PURE__*/_jsxs(ErrorContainer,{children:[/*#__PURE__*/_jsxs(ErrorMessage,{isServiceUnavailable:error.isServiceUnavailable,children:[\"\\u8F09\\u5165\\u5931\\u6557: \",error.message]}),apiCallCount>=10&&/*#__PURE__*/_jsx(\"div\",{style:{background:'#fff3cd',border:'1px solid #ffeaa7',padding:'10px',borderRadius:'5px',marginTop:'10px',fontSize:'0.9rem',color:'#856404'},children:\"\\u5DF2\\u9054\\u5230API\\u8ABF\\u7528\\u9650\\u5236\\uFF0C\\u4F7F\\u7528\\u9810\\u8A2D\\u9078\\u9805\"}),/*#__PURE__*/_jsx(RetryButton,{onClick:()=>fetchAiOptions(selectedSymptom,currentStep===2,selectedOption),children:\"\\u91CD\\u8A66\"})]});}// 第一層：多維度評估\nif(currentStep===1&&dimensionData){const currentDimensions=dimensionData.dimensions;return/*#__PURE__*/_jsxs(AiOptionsContainer,{children:[/*#__PURE__*/_jsxs(ProgressIndicator,{children:[/*#__PURE__*/_jsx(ProgressStep,{active:currentStep>=1}),/*#__PURE__*/_jsx(ProgressText,{active:currentStep>=1,children:\"\\u591A\\u7DAD\\u5EA6\\u8A55\\u4F30\"}),/*#__PURE__*/_jsx(ProgressStep,{active:currentStep>=2}),/*#__PURE__*/_jsx(ProgressText,{active:currentStep>=2,children:\"AI\\u7CBE\\u7D30\\u5206\\u6790\"})]}),/*#__PURE__*/_jsx(\"h2\",{style:{marginBottom:'30px',textAlign:'center',color:'#2c3e50'},children:\"\\u8ACB\\u5B8C\\u6210\\u4EE5\\u4E0B\\u8A55\\u4F30\\u9805\\u76EE\"}),/*#__PURE__*/_jsx(\"div\",{style:{display:'flex',flexDirection:'column',gap:'25px'},children:currentDimensions.map((dimension,dimensionIndex)=>/*#__PURE__*/_jsxs(\"div\",{style:{border:'1px solid #e0e0e0',borderRadius:'10px',padding:'20px',background:'#fafafa'},children:[/*#__PURE__*/_jsx(\"h3\",{style:{marginBottom:'15px',color:'#2c3e50',fontSize:'1.2rem',fontWeight:'600'},children:dimension.title}),selectedSymptom==='pain'&&dimension.id==='pain_level'&&/*#__PURE__*/_jsxs(\"div\",{style:{marginBottom:'15px'},children:[/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',justifyContent:'space-between',alignItems:'center',marginBottom:'15px'},children:[/*#__PURE__*/_jsx(\"span\",{style:{fontSize:'0.9rem',color:'#666'},children:\"VAS\\u75BC\\u75DB\\u91CF\\u8868\\uFF1A\"}),/*#__PURE__*/_jsxs(\"span\",{style:{fontSize:'1.1rem',fontWeight:'bold',color:'#667eea',minWidth:'40px',textAlign:'center'},children:[dimensionSelections[dimension.id]||'0',\"/10\"]})]}),/*#__PURE__*/_jsx(\"div\",{style:{position:'relative',background:'linear-gradient(to right, #4caf50, #ff9800, #f44336)',height:'8px',borderRadius:'4px',marginBottom:'10px',cursor:'pointer'},onClick:e=>{const rect=e.currentTarget.getBoundingClientRect();const x=e.clientX-rect.left;const percentage=Math.max(0,Math.min(1,x/rect.width));const score=Math.round(percentage*10);handleDimensionSelect(dimension.id,score.toString());},children:/*#__PURE__*/_jsx(\"div\",{style:{position:'absolute',top:'-4px',left:`${parseInt(dimensionSelections[dimension.id]||0)/10*100}%`,width:'16px',height:'16px',borderRadius:'50%',background:'#667eea',border:'2px solid #fff',boxShadow:'0 2px 4px rgba(0,0,0,0.2)',pointerEvents:'none',transform:'translateX(-50%)'}})}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',justifyContent:'space-between',fontSize:'0.75rem',color:'#666',marginTop:'5px'},children:[/*#__PURE__*/_jsx(\"span\",{children:\"\\u7121\\u75DB\"}),/*#__PURE__*/_jsx(\"span\",{children:\"\\u6700\\u75DB\"})]})]}),dimension.options.length>0&&/*#__PURE__*/_jsx(\"div\",{style:{display:'grid',gridTemplateColumns:'repeat(2, 1fr)',gap:'10px',marginTop:'10px'},children:dimension.options.map((option,optionIndex)=>/*#__PURE__*/_jsxs(\"div\",{onClick:()=>handleDimensionSelect(dimension.id,option.id),style:{padding:'10px 12px',borderRadius:'8px',border:'2px solid',borderColor:dimensionSelections[dimension.id]===option.id?'#667eea':'#e0e0e0',background:dimensionSelections[dimension.id]===option.id?'#667eea':'#fff',color:dimensionSelections[dimension.id]===option.id?'#fff':'#2c3e50',cursor:'pointer',transition:'all 0.2s ease',display:'flex',flexDirection:'column',gap:'3px',minHeight:'60px',justifyContent:'center'},children:[/*#__PURE__*/_jsx(\"div\",{style:{fontWeight:'600',fontSize:'0.9rem',textAlign:'center'},children:option.title}),option.description&&/*#__PURE__*/_jsx(\"div\",{style:{fontSize:'0.75rem',opacity:dimensionSelections[dimension.id]===option.id?'0.9':'0.7',textAlign:'center'},children:option.description})]},option.id))})]},dimension.id))}),Object.keys(dimensionSelections).length===currentDimensions.length&&/*#__PURE__*/_jsxs(\"div\",{style:{marginTop:'30px',textAlign:'center',padding:'20px',background:'#e8f5e8',borderRadius:'10px',border:'1px solid #4caf50'},children:[/*#__PURE__*/_jsx(\"p\",{style:{margin:'0 0 15px 0',color:'#2e7d32',fontWeight:'600'},children:\"\\u2705 \\u6240\\u6709\\u8A55\\u4F30\\u9805\\u76EE\\u5DF2\\u5B8C\\u6210\"}),/*#__PURE__*/_jsx(ActionButton,{primary:true,onClick:async()=>{setCurrentStep(2);setLoading(true);// 調用AI API生成初步主訴\nawait fetchAiOptions(selectedSymptom,true,'combined',2);},children:\"\\u7E7C\\u7E8C\\u9032\\u884C\\u521D\\u6B65\\u4E3B\\u8A34\"})]})]});}// 第二層或第三層：AI主訴分析\nlet options,selectedId,onOptionSelect,stepTitle;if(currentStep===2){// 第二層：初步主訴\noptions=subOptions;selectedId=selectedSubOption;onOptionSelect=handleSubOptionSelect;stepTitle='AI正在模擬病人的初步主訴...';}else if(currentStep===3){// 第三層：詳細主訴\noptions=detailedOptions;selectedId=selectedDetailedOption;onOptionSelect=handleDetailedOptionSelect;stepTitle='AI正在生成更詳細的主訴描述...';}if(options.length===0){return/*#__PURE__*/_jsx(ErrorContainer,{children:/*#__PURE__*/_jsx(ErrorMessage,{children:\"\\u7121\\u6CD5\\u8F09\\u5165\\u9078\\u9805\"})});}return/*#__PURE__*/_jsxs(AiOptionsContainer,{children:[/*#__PURE__*/_jsxs(ProgressIndicator,{children:[/*#__PURE__*/_jsx(ProgressStep,{active:currentStep>=1}),/*#__PURE__*/_jsx(ProgressText,{active:currentStep>=1,children:\"\\u591A\\u7DAD\\u5EA6\\u8A55\\u4F30\"}),/*#__PURE__*/_jsx(ProgressStep,{active:currentStep>=2}),/*#__PURE__*/_jsx(ProgressText,{active:currentStep>=2,children:\"\\u521D\\u6B65\\u4E3B\\u8A34\"}),/*#__PURE__*/_jsx(ProgressStep,{active:currentStep>=3}),/*#__PURE__*/_jsx(ProgressText,{active:currentStep>=3,children:\"\\u8A73\\u7D30\\u4E3B\\u8A34\"})]}),/*#__PURE__*/_jsx(\"h2\",{style:{marginBottom:'30px',textAlign:'center',color:'#2c3e50'},children:stepTitle}),apiCallCount>0&&(currentStep===2||currentStep===3)&&/*#__PURE__*/_jsxs(\"div\",{style:{background:'#e3f2fd',border:'1px solid #bbdefb',padding:'8px 12px',borderRadius:'5px',marginBottom:'15px',fontSize:'0.8rem',color:'#1976d2',textAlign:'center'},children:[\"AI\\u5206\\u6790\\u6B21\\u6578: \",apiCallCount,\"/10 \",apiCallCount>=8&&'(接近限制)']}),/*#__PURE__*/_jsx(\"div\",{style:{display:'flex',flexDirection:'column',gap:'15px'},children:options.map((option,index)=>/*#__PURE__*/_jsxs(OptionCard,{selected:selectedId===option.id,onClick:()=>onOptionSelect(option.id),delay:index*0.1,children:[/*#__PURE__*/_jsx(OptionTitle,{children:option.title}),/*#__PURE__*/_jsx(OptionDescription,{children:option.description})]},option.id))})]});};const renderAiSummary=()=>{var _symptoms$find2;const selectedSubOptionData=subOptions.find(option=>option.id===selectedSubOption);const selectedDetailedOptionData=detailedOptions.find(option=>option.id===selectedDetailedOption);const symptomName=(_symptoms$find2=symptoms.find(s=>s.id===selectedSymptom))===null||_symptoms$find2===void 0?void 0:_symptoms$find2.title;return/*#__PURE__*/_jsxs(SummaryContainer,{children:[/*#__PURE__*/_jsxs(\"h3\",{style:{textAlign:'center',marginBottom:'20px',color:'#2c3e50'},children:[symptomName,\"\\u8A55\\u4F30\\u7E3D\\u7D50\"]}),dimensionData&&Object.keys(dimensionSelections).length>0&&/*#__PURE__*/_jsxs(\"div\",{style:{marginBottom:'20px'},children:[/*#__PURE__*/_jsx(\"h4\",{style:{color:'#2c3e50',marginBottom:'15px'},children:\"\\u591A\\u7DAD\\u5EA6\\u8A55\\u4F30\\u7D50\\u679C\\uFF1A\"}),dimensionData.dimensions.map((dimension,index)=>{const selectedOptionId=dimensionSelections[dimension.id];const selectedOption=dimension.options.find(opt=>opt.id===selectedOptionId);// 跳過疼痛程度的分數顯示，只顯示其他維度\nif(selectedSymptom==='pain'&&dimension.id==='pain_level'){return null;}return/*#__PURE__*/_jsxs(SummaryItem,{children:[/*#__PURE__*/_jsxs(SummaryLabel,{children:[dimension.title,\"\\uFF1A\"]}),/*#__PURE__*/_jsx(SummaryValue,{children:(selectedOption===null||selectedOption===void 0?void 0:selectedOption.title)||'未選擇'})]},dimension.id);})]}),selectedSubOptionData&&/*#__PURE__*/_jsxs(\"div\",{style:{marginTop:'20px'},children:[/*#__PURE__*/_jsx(\"h4\",{style:{color:'#2c3e50',marginBottom:'15px'},children:\"\\u521D\\u6B65\\u4E3B\\u8A34\\uFF1A\"}),/*#__PURE__*/_jsxs(SummaryItem,{children:[/*#__PURE__*/_jsx(SummaryLabel,{children:\"\\u4E3B\\u8A34\\uFF1A\"}),/*#__PURE__*/_jsx(SummaryValue,{children:selectedSubOptionData.title})]}),/*#__PURE__*/_jsxs(SummaryItem,{children:[/*#__PURE__*/_jsx(SummaryLabel,{children:\"\\u8A73\\u7D30\\u63CF\\u8FF0\\uFF1A\"}),/*#__PURE__*/_jsx(SummaryValue,{children:selectedSubOptionData.description})]})]}),selectedDetailedOptionData&&/*#__PURE__*/_jsxs(\"div\",{style:{marginTop:'20px'},children:[/*#__PURE__*/_jsx(\"h4\",{style:{color:'#2c3e50',marginBottom:'15px'},children:\"\\u8A73\\u7D30\\u4E3B\\u8A34\\uFF1A\"}),/*#__PURE__*/_jsxs(SummaryItem,{children:[/*#__PURE__*/_jsx(SummaryLabel,{children:\"\\u4E3B\\u8A34\\uFF1A\"}),/*#__PURE__*/_jsx(SummaryValue,{children:selectedDetailedOptionData.title})]}),/*#__PURE__*/_jsxs(SummaryItem,{children:[/*#__PURE__*/_jsx(SummaryLabel,{children:\"\\u8A73\\u7D30\\u63CF\\u8FF0\\uFF1A\"}),/*#__PURE__*/_jsx(SummaryValue,{children:selectedDetailedOptionData.description})]})]}),/*#__PURE__*/_jsx(\"div\",{style:{marginTop:'20px',textAlign:'center'},children:/*#__PURE__*/_jsx(ActionButton,{onClick:()=>{setShowAiSummary(false);if(selectedDetailedOptionData){setSelectedDetailedOption(null);setDetailedOptions([]);setCurrentStep(3);}else{setSelectedSubOption(null);setCurrentStep(2);}},children:\"\\u91CD\\u65B0\\u9078\\u64C7\\u4E3B\\u8A34\"})})]});};return/*#__PURE__*/_jsxs(AppContainer,{children:[/*#__PURE__*/_jsx(ApiKeySetup,{}),/*#__PURE__*/_jsxs(Header,{children:[/*#__PURE__*/_jsx(Title,{children:\"\\u8853\\u5F8C\\u4E3B\\u8A34\\u8868\\u9054\\u7CFB\\u7D71\"}),/*#__PURE__*/_jsx(Subtitle,{children:\"\\u8ACB\\u9078\\u64C7\\u60A8\\u76EE\\u524D\\u7684\\u4E3B\\u8981\\u4E0D\\u9069\\u75C7\\u72C0\"})]}),/*#__PURE__*/_jsxs(ContentCard,{children:[/*#__PURE__*/_jsxs(StepIndicator,{children:[/*#__PURE__*/_jsx(Step,{active:!selectedSymptom,children:\"\\u9078\\u64C7\\u4E3B\\u8A34\"}),/*#__PURE__*/_jsx(Step,{active:selectedSymptom&&!showAiSummary,children:\"\\u8A55\\u4F30\\u4E2D\"}),/*#__PURE__*/_jsx(Step,{active:showAiSummary,children:\"\\u5B8C\\u6210\"})]}),!selectedSymptom&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"h2\",{style:{marginBottom:'30px',color:'#2c3e50',textAlign:'center',fontSize:'1.8rem'},children:\"\\u8ACB\\u9078\\u64C7\\u60A8\\u76EE\\u524D\\u7684\\u4E3B\\u8981\\u4E3B\\u8A34\"}),/*#__PURE__*/_jsx(SymptomGrid,{children:symptoms.map((symptom,index)=>{const IconComponent=symptom.icon;return/*#__PURE__*/_jsxs(SymptomCard,{onClick:()=>debouncedSymptomSelect(symptom.id),style:{animationDelay:`${index*0.1}s`},children:[/*#__PURE__*/_jsx(SymptomIcon,{children:/*#__PURE__*/_jsx(IconComponent,{size:32})}),/*#__PURE__*/_jsx(\"h3\",{children:symptom.title}),/*#__PURE__*/_jsx(\"p\",{children:symptom.description})]},symptom.id);})})]}),selectedSymptom&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(NavigationBar,{children:[/*#__PURE__*/_jsxs(NavButton,{onClick:handleBack,children:[/*#__PURE__*/_jsx(ArrowLeft,{size:18}),currentStep===2?'返回上一步':'返回選擇主訴']}),/*#__PURE__*/_jsxs(NavButton,{onClick:handleReset,children:[/*#__PURE__*/_jsx(Home,{size:18}),\"\\u91CD\\u65B0\\u958B\\u59CB\"]})]}),/*#__PURE__*/_jsxs(\"h2\",{style:{marginBottom:'20px',color:'#2c3e50',textAlign:'center',fontSize:'1.8rem'},children:[(_symptoms$find3=symptoms.find(s=>s.id===selectedSymptom))===null||_symptoms$find3===void 0?void 0:_symptoms$find3.title,\"\\u8A55\\u4F30\"]}),!showAiSummary&&renderAiOptions(),showAiSummary&&renderAiSummary(),/*#__PURE__*/_jsxs(ButtonContainer,{children:[/*#__PURE__*/_jsx(ActionButton,{onClick:handleBack,children:currentStep===2?'返回上一步':'返回選擇主訴'}),showAiSummary&&/*#__PURE__*/_jsx(ActionButton,{primary:true,onClick:handleReset,children:\"\\u5B8C\\u6210\\u4E26\\u91CD\\u65B0\\u958B\\u59CB\"})]})]})]})]});}export default App;","map":{"version":3,"names":["React","useState","useCallback","styled","keyframes","Activity","Bed","Droplets","ArrowLeft","Home","googleAiService","ApiKeySetup","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","fadeIn","slideIn","pulse","bounce","AppContainer","div","ContentCard","Header","Title","h1","Subtitle","p","NavigationBar","NavButton","button","StepIndicator","Step","props","active","SymptomGrid","SymptomCard","selected","SymptomIcon","ActionButton","primary","ButtonContainer","SummaryContainer","SummaryItem","SummaryLabel","span","SummaryValue","LoadingContainer","LoadingSpinner","LoadingText","LoadingDots","Dot","delay","AiOptionsContainer","OptionCard","OptionTitle","h3","OptionDescription","ErrorContainer","ErrorMessage","isServiceUnavailable","RetryButton","ProgressIndicator","ProgressStep","ProgressText","App","_symptoms$find3","selectedSymptom","setSelectedSymptom","aiOptions","setAiOptions","selectedOption","setSelectedOption","subOptions","setSubOptions","selectedSubOption","setSelectedSubOption","detailedOptions","setDetailedOptions","selectedDetailedOption","setSelectedDetailedOption","loading","setLoading","error","setError","message","showAiSummary","setShowAiSummary","currentStep","setCurrentStep","apiCallCount","setApiCallCount","isProcessing","setIsProcessing","dimensionSelections","setDimensionSelections","dimensionData","setDimensionData","symptoms","id","title","description","icon","fetchAiOptions","symptomId","isSubLevel","arguments","length","undefined","parentOption","step","getDefaultOptions","console","warn","getDefaultSubOptions","prev","_symptoms$find","symptomName","find","s","combinedDescription","descriptions","dimensions","forEach","dimension","selectedOptionId","push","options","opt","join","data","generateSymptomOptions","targetStep","err","errorMessage","includes","setTimeout","defaultOptions","pain","sleep","tube","excretion","_defaultSubOptions$sy","defaultSubOptions","mild_pain","moderate_pain","severe_pain","localized_pain","radiating_pain","intermittent_pain","difficulty_falling","frequent_waking","early_waking","less_than_4","more_than_8","anxiety","environment","breathing","normal_condition","mild_discomfort","serious_issue","irritation","pressure_discomfort","movement_restriction","urination_issue","bowel_issue","no_issue","frequency_change","incontinence","blood_in_stool","handleSymptomSelect","symptomData","handleDimensionSelect","dimensionId","optionId","handleOptionSelect","handleSubOptionSelect","subOptionId","handleDetailedOptionSelect","detailedOptionId","handleBack","handleReset","debouncedSymptomSelect","renderAiOptions","children","style","marginTop","fontSize","color","background","border","padding","borderRadius","onClick","currentDimensions","marginBottom","textAlign","display","flexDirection","gap","map","dimensionIndex","fontWeight","justifyContent","alignItems","minWidth","position","height","cursor","e","rect","currentTarget","getBoundingClientRect","x","clientX","left","percentage","Math","max","min","width","score","round","toString","top","parseInt","boxShadow","pointerEvents","transform","gridTemplateColumns","option","optionIndex","borderColor","transition","minHeight","opacity","Object","keys","margin","selectedId","onOptionSelect","stepTitle","index","renderAiSummary","_symptoms$find2","selectedSubOptionData","selectedDetailedOptionData","symptom","IconComponent","animationDelay","size"],"sources":["/Users/chad/oral_surgery_app_AI_version_20250807_012728/src/App.js"],"sourcesContent":["import React, { useState, useCallback } from 'react';\nimport styled, { keyframes } from 'styled-components';\nimport { Activity, Bed, Droplets, ArrowLeft, Home } from 'lucide-react';\nimport googleAiService from './services/googleAiService';\nimport ApiKeySetup from './components/ApiKeySetup';\n\n// 動畫定義\nconst fadeIn = keyframes`\n  from {\n    opacity: 0;\n    transform: translateY(20px);\n  }\n  to {\n    opacity: 1;\n    transform: translateY(0);\n  }\n`;\n\nconst slideIn = keyframes`\n  from {\n    opacity: 0;\n    transform: translateX(-20px);\n  }\n  to {\n    opacity: 1;\n    transform: translateX(0);\n  }\n`;\n\nconst pulse = keyframes`\n  0%, 100% {\n    opacity: 1;\n  }\n  50% {\n    opacity: 0.5;\n  }\n`;\n\nconst bounce = keyframes`\n  0%, 20%, 53%, 80%, 100% {\n    transform: translate3d(0,0,0);\n  }\n  40%, 43% {\n    transform: translate3d(0, -8px, 0);\n  }\n  70% {\n    transform: translate3d(0, -4px, 0);\n  }\n  90% {\n    transform: translate3d(0, -2px, 0);\n  }\n`;\n\nconst AppContainer = styled.div`\n  max-width: 900px;\n  margin: 0 auto;\n  padding: 20px;\n  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n  min-height: 100vh;\n  color: white;\n`;\n\nconst ContentCard = styled.div`\n  background: white;\n  border-radius: 20px;\n  padding: 30px;\n  box-shadow: 0 10px 30px rgba(0,0,0,0.2);\n  color: #2c3e50;\n  animation: ${fadeIn} 0.6s ease-out;\n`;\n\nconst Header = styled.div`\n  text-align: center;\n  margin-bottom: 30px;\n`;\n\nconst Title = styled.h1`\n  color: white;\n  margin-bottom: 10px;\n  font-size: 2.5rem;\n  font-weight: 700;\n`;\n\nconst Subtitle = styled.p`\n  color: rgba(255,255,255,0.9);\n  font-size: 1.1rem;\n  margin: 0;\n`;\n\nconst NavigationBar = styled.div`\n  display: flex;\n  align-items: center;\n  margin-bottom: 20px;\n  gap: 15px;\n`;\n\nconst NavButton = styled.button`\n  background: rgba(255,255,255,0.2);\n  border: none;\n  color: white;\n  padding: 10px 15px;\n  border-radius: 25px;\n  cursor: pointer;\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  font-size: 1rem;\n  transition: all 0.3s ease;\n  \n  &:hover {\n    background: rgba(255,255,255,0.3);\n    transform: translateY(-2px);\n  }\n`;\n\nconst StepIndicator = styled.div`\n  display: flex;\n  justify-content: center;\n  margin-bottom: 30px;\n`;\n\nconst Step = styled.div`\n  display: flex;\n  align-items: center;\n  color: ${props => props.active ? 'white' : 'rgba(255,255,255,0.6)'};\n  font-weight: ${props => props.active ? 'bold' : 'normal'};\n  \n  &:not(:last-child)::after {\n    content: '→';\n    margin: 0 15px;\n    color: rgba(255,255,255,0.6);\n  }\n`;\n\nconst SymptomGrid = styled.div`\n  display: grid;\n  grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));\n  gap: 20px;\n  margin-bottom: 30px;\n`;\n\nconst SymptomCard = styled.div`\n  background: ${props => props.selected ? '#667eea' : 'white'};\n  color: ${props => props.selected ? 'white' : '#2c3e50'};\n  padding: 25px;\n  border-radius: 15px;\n  border: 2px solid ${props => props.selected ? '#667eea' : '#e0e0e0'};\n  cursor: pointer;\n  transition: all 0.3s ease;\n  text-align: center;\n  animation: ${fadeIn} 0.6s ease-out;\n  \n  &:hover {\n    transform: translateY(-5px);\n    box-shadow: 0 10px 25px rgba(0,0,0,0.15);\n  }\n`;\n\nconst SymptomIcon = styled.div`\n  margin-bottom: 15px;\n  color: #667eea;\n`;\n\nconst ActionButton = styled.button`\n  background: ${props => props.primary ? '#667eea' : 'rgba(102, 126, 234, 0.1)'};\n  color: ${props => props.primary ? 'white' : '#667eea'};\n  border: 2px solid #667eea;\n  padding: 12px 24px;\n  border-radius: 25px;\n  cursor: pointer;\n  font-size: 1rem;\n  font-weight: 600;\n  transition: all 0.3s ease;\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  \n  &:hover {\n    background: ${props => props.primary ? '#5a6fd8' : 'rgba(102, 126, 234, 0.2)'};\n    transform: translateY(-2px);\n  }\n`;\n\nconst ButtonContainer = styled.div`\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-top: 30px;\n  gap: 15px;\n`;\n\nconst SummaryContainer = styled.div`\n  background: #f8f9fa;\n  border-radius: 15px;\n  padding: 25px;\n  margin: 20px 0;\n  animation: ${fadeIn} 0.6s ease-out;\n`;\n\nconst SummaryItem = styled.div`\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 10px 0;\n  border-bottom: 1px solid #e9ecef;\n  \n  &:last-child {\n    border-bottom: none;\n  }\n`;\n\nconst SummaryLabel = styled.span`\n  font-weight: 600;\n  color: #495057;\n`;\n\nconst SummaryValue = styled.span`\n  color: #667eea;\n  font-weight: 500;\n`;\n\n// 載入動畫組件\nconst LoadingContainer = styled.div`\n  text-align: center;\n  padding: 60px 40px;\n  animation: ${fadeIn} 0.5s ease-out;\n`;\n\nconst LoadingSpinner = styled.div`\n  display: inline-block;\n  width: 60px;\n  height: 60px;\n  border: 4px solid #f3f3f3;\n  border-top: 4px solid #667eea;\n  border-radius: 50%;\n  animation: spin 1s linear infinite;\n  \n  @keyframes spin {\n    0% { transform: rotate(0deg); }\n    100% { transform: rotate(360deg); }\n  }\n`;\n\nconst LoadingText = styled.p`\n  margin-top: 20px;\n  font-size: 1.1rem;\n  color: #2c3e50;\n  animation: ${pulse} 2s ease-in-out infinite;\n`;\n\nconst LoadingDots = styled.div`\n  display: flex;\n  justify-content: center;\n  gap: 4px;\n  margin-top: 10px;\n`;\n\nconst Dot = styled.div`\n  width: 8px;\n  height: 8px;\n  border-radius: 50%;\n  background: #667eea;\n  animation: ${bounce} 1.4s ease-in-out infinite both;\n  animation-delay: ${props => props.delay}s;\n`;\n\n// AI選項容器\nconst AiOptionsContainer = styled.div`\n  animation: ${fadeIn} 0.6s ease-out;\n`;\n\nconst OptionCard = styled.button`\n  padding: 20px;\n  border: 2px solid #e0e0e0;\n  border-radius: 15px;\n  background: ${props => props.selected ? '#667eea' : 'white'};\n  color: ${props => props.selected ? 'white' : '#2c3e50'};\n  cursor: pointer;\n  font-size: 1rem;\n  transition: all 0.3s ease;\n  text-align: left;\n  margin-bottom: 15px;\n  animation: ${slideIn} 0.6s ease-out;\n  animation-delay: ${props => props.delay}s;\n  \n  &:hover {\n    transform: translateY(-2px);\n    box-shadow: 0 8px 20px rgba(0,0,0,0.1);\n    border-color: #667eea;\n  }\n  \n  &:active {\n    transform: translateY(0);\n  }\n`;\n\nconst OptionTitle = styled.h3`\n  margin: 0 0 10px 0;\n  font-size: 1.2rem;\n  font-weight: 600;\n`;\n\nconst OptionDescription = styled.p`\n  margin: 0;\n  opacity: 0.8;\n  line-height: 1.5;\n`;\n\n// 錯誤容器\nconst ErrorContainer = styled.div`\n  text-align: center;\n  padding: 40px;\n  animation: ${fadeIn} 0.5s ease-out;\n`;\n\nconst ErrorMessage = styled.p`\n  color: ${props => props.isServiceUnavailable ? '#856404' : '#e74c3c'};\n  font-size: 1.1rem;\n  margin-bottom: 20px;\n  background: ${props => props.isServiceUnavailable ? '#fff3cd' : '#f8d7da'};\n  border: 1px solid ${props => props.isServiceUnavailable ? '#ffeaa7' : '#f5c6cb'};\n  padding: 15px;\n  border-radius: 8px;\n`;\n\nconst RetryButton = styled(ActionButton)`\n  background: #28a745;\n  color: white;\n  border-color: #28a745;\n  \n  &:hover {\n    background: #218838;\n  }\n`;\n\n// 進度指示器\nconst ProgressIndicator = styled.div`\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  margin-bottom: 20px;\n  gap: 10px;\n`;\n\nconst ProgressStep = styled.div`\n  width: 12px;\n  height: 12px;\n  border-radius: 50%;\n  background: ${props => props.active ? '#667eea' : '#e0e0e0'};\n  transition: all 0.3s ease;\n`;\n\nconst ProgressText = styled.span`\n  font-size: 0.9rem;\n  color: ${props => props.active ? '#667eea' : '#666'};\n  font-weight: ${props => props.active ? 'bold' : 'normal'};\n`;\n\nfunction App() {\n  const [selectedSymptom, setSelectedSymptom] = useState(null);\n  const [aiOptions, setAiOptions] = useState([]);\n  const [selectedOption, setSelectedOption] = useState(null);\n  const [subOptions, setSubOptions] = useState([]);\n  const [selectedSubOption, setSelectedSubOption] = useState(null);\n  const [detailedOptions, setDetailedOptions] = useState([]);\n  const [selectedDetailedOption, setSelectedDetailedOption] = useState(null);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState({ message: '', isServiceUnavailable: false });\n  const [showAiSummary, setShowAiSummary] = useState(false);\n  const [currentStep, setCurrentStep] = useState(1);\n  const [apiCallCount, setApiCallCount] = useState(0); // 添加API調用計數器\n  const [isProcessing, setIsProcessing] = useState(false); // 添加防抖機制\n  \n  // 多維度評估狀態\n  const [dimensionSelections, setDimensionSelections] = useState({});\n\n  const [dimensionData, setDimensionData] = useState(null);\n\n  const symptoms = [\n    {\n      id: 'pain',\n      title: '疼痛',\n      description: '評估疼痛程度、位置和性質',\n      icon: Activity\n    },\n    {\n      id: 'sleep',\n      title: '睡眠困難',\n      description: '評估睡眠質量和相關問題',\n      icon: Bed\n    },\n    {\n      id: 'tube',\n      title: '管路問題',\n      description: '評估各種管路的狀況',\n      icon: Droplets\n    },\n    {\n      id: 'excretion',\n      title: '排泄問題',\n      description: '評估大小便相關問題',\n      icon: Droplets\n    }\n  ];\n\n  // 使用 useCallback 來避免不必要的重新渲染\n  const fetchAiOptions = useCallback(async (symptomId, isSubLevel = false, parentOption = null, step = null) => {\n    // 第一層使用預設選項，不需要API調用\n    if (!isSubLevel) {\n      setLoading(false);\n      setError({ message: '', isServiceUnavailable: false });\n      setAiOptions(getDefaultOptions(symptomId));\n      return;\n    }\n\n    // 限制API調用次數，防止過載\n    if (apiCallCount >= 10) {\n      console.warn('API調用次數過多，使用預設選項');\n      setSubOptions(getDefaultSubOptions(symptomId, parentOption));\n      setLoading(false);\n      return;\n    }\n\n    setLoading(true);\n    setError({ message: '', isServiceUnavailable: false });\n    setApiCallCount(prev => prev + 1);\n    \n    try {\n      const symptomName = symptoms.find(s => s.id === symptomId)?.title;\n      \n      // 如果是多維度評估的結果，構建綜合描述\n      let combinedDescription = '';\n      if (parentOption === 'combined' && dimensionData && dimensionSelections) {\n        const descriptions = [];\n        dimensionData.dimensions.forEach(dimension => {\n          const selectedOptionId = dimensionSelections[dimension.id];\n          \n          // 特殊處理疼痛程度（VAS）\n          if (symptomId === 'pain' && dimension.id === 'pain_level') {\n            if (selectedOptionId !== undefined) {\n              descriptions.push(`${dimension.title}: ${selectedOptionId}/10分`);\n            }\n          } else {\n            // 處理其他維度\n            const selectedOption = dimension.options.find(opt => opt.id === selectedOptionId);\n            if (selectedOption) {\n              descriptions.push(`${dimension.title}: ${selectedOption.title}`);\n            }\n          }\n        });\n        combinedDescription = descriptions.join('; ');\n      }\n      \n      const data = await googleAiService.generateSymptomOptions(symptomId, symptomName, isSubLevel, parentOption, combinedDescription);\n      \n      const targetStep = step || currentStep;\n      if (targetStep === 2) {\n        setSubOptions(data.options || []);\n        setSelectedSubOption(null);\n      } else if (targetStep === 3) {\n        setDetailedOptions(data.options || []);\n        setSelectedDetailedOption(null);\n      }\n    } catch (err) {\n      console.error('Google AI服務失敗:', err);\n      \n      // 確保錯誤對象有正確的結構\n      const errorMessage = err && err.message ? err.message : '未知錯誤';\n      \n      // 檢查是否是服務不可用錯誤\n      if (errorMessage.includes('503') || errorMessage.includes('overloaded') || errorMessage.includes('UNAVAILABLE')) {\n        setError({ message: 'AI服務暫時不可用，正在使用預設選項...', isServiceUnavailable: true });\n        // 延遲一下讓用戶看到錯誤信息\n        setTimeout(() => {\n          const targetStep = step || currentStep;\n          if (targetStep === 2) {\n            setSubOptions(getDefaultSubOptions(symptomId, parentOption));\n          } else if (targetStep === 3) {\n            setDetailedOptions(getDefaultSubOptions(symptomId, parentOption));\n          }\n          setError({ message: '', isServiceUnavailable: false });\n        }, 2000);\n      } else {\n        setError({ message: errorMessage, isServiceUnavailable: false });\n        // 如果Google AI服務失敗，使用預設選項\n        const targetStep = step || currentStep;\n        if (targetStep === 2) {\n          setSubOptions(getDefaultSubOptions(symptomId, parentOption));\n        } else if (targetStep === 3) {\n          setDetailedOptions(getDefaultSubOptions(symptomId, parentOption));\n        }\n      }\n    } finally {\n      setLoading(false);\n    }\n  }, [apiCallCount, symptoms, dimensionData, dimensionSelections, currentStep]);\n\n  const getDefaultOptions = (symptomId) => {\n    const defaultOptions = {\n      pain: {\n        dimensions: [\n          {\n            id: 'pain_level',\n            title: '疼痛程度',\n            options: [] // 使用VAS滑動條，不需要選項\n          },\n          {\n            id: 'pain_location',\n            title: '疼痛位置',\n            options: [\n              { id: 'incision', title: '手術切口', description: '' },\n              { id: 'tooth', title: '牙齒', description: '' },\n              { id: 'throat', title: '喉嚨', description: '' },\n              { id: 'head', title: '頭部', description: '' },\n              { id: 'neck', title: '頸部', description: '' },\n              { id: 'chest', title: '胸部', description: '' }\n            ]\n          },\n          {\n            id: 'pain_nature',\n            title: '疼痛性質',\n            options: [\n              { id: 'dull', title: '鈍痛', description: '' },\n              { id: 'sharp', title: '刺痛', description: '' },\n              { id: 'throbbing', title: '跳痛', description: '' },\n              { id: 'burning', title: '灼痛', description: '' },\n              { id: 'aching', title: '隱痛', description: '' },\n              { id: 'cramping', title: '痙攣痛', description: '' }\n            ]\n          },\n          {\n            id: 'pain_pattern',\n            title: '疼痛模式',\n            options: [\n              { id: 'continuous', title: '持續性', description: '' },\n              { id: 'intermittent', title: '間歇性', description: '' },\n              { id: 'activity_related', title: '活動相關', description: '' },\n              { id: 'position_related', title: '姿勢相關', description: '' },\n              { id: 'time_related', title: '時間相關', description: '' }\n            ]\n          }\n        ]\n      },\n      sleep: {\n        dimensions: [\n          {\n            id: 'sleep_problems',\n            title: '睡眠問題',\n            options: [\n              { id: 'difficulty_falling', title: '入睡困難', description: '' },\n              { id: 'frequent_waking', title: '容易醒來', description: '' },\n              { id: 'early_waking', title: '早醒', description: '' }\n            ]\n          },\n          {\n            id: 'sleep_duration',\n            title: '睡眠時長',\n            options: [\n              { id: 'less_than_4', title: '少於4小時', description: '' },\n              { id: '4_to_6', title: '4-6小時', description: '' },\n              { id: '6_to_8', title: '6-8小時', description: '' },\n              { id: 'more_than_8', title: '8小時以上', description: '' }\n            ]\n          },\n          {\n            id: 'sleep_disturbance',\n            title: '干擾因素',\n            options: [\n              { id: 'pain', title: '疼痛', description: '' },\n              { id: 'anxiety', title: '焦慮', description: '' },\n              { id: 'environment', title: '環境', description: '' },\n              { id: 'breathing', title: '呼吸問題', description: '' },\n              { id: 'none', title: '無干擾', description: '' }\n            ]\n          }\n        ]\n      },\n      tube: {\n        dimensions: [\n          {\n            id: 'tube_type',\n            title: '哪一管路問題',\n            options: [\n              { id: 'nasogastric', title: '鼻胃管', description: '' },\n              { id: 'drainage', title: '引流管', description: '' },\n              { id: 'tracheostomy', title: '氣切管', description: '' },\n              { id: 'catheter', title: '導尿管', description: '' }\n            ]\n          },\n          {\n            id: 'tube_abnormal',\n            title: '異常情形',\n            options: [\n              { id: 'bleeding', title: '滲血', description: '' },\n              { id: 'discharge', title: '分泌物變多', description: '' },\n              { id: 'loose', title: '管路鬆動', description: '' },\n              { id: 'pain', title: '疼痛', description: '' }\n            ]\n          },\n          {\n            id: 'tube_color',\n            title: '顏色變化',\n            options: [\n              { id: 'normal', title: '正常', description: '' },\n              { id: 'yellow', title: '發黃', description: '' },\n              { id: 'green', title: '發綠', description: '' },\n              { id: 'red', title: '發紅', description: '' }\n            ]\n          }\n        ]\n      },\n      excretion: {\n        dimensions: [\n          {\n            id: 'urination_status',\n            title: '小便狀況',\n            options: [\n              { id: 'normal', title: '正常', description: '' },\n              { id: 'difficulty', title: '排尿困難', description: '' },\n              { id: 'frequency_change', title: '頻率改變', description: '' },\n              { id: 'incontinence', title: '尿失禁', description: '' },\n              { id: 'blood_urine', title: '血尿', description: '' }\n            ]\n          },\n          {\n            id: 'bowel_status',\n            title: '大便狀況',\n            options: [\n              { id: 'normal', title: '正常', description: '' },\n              { id: 'constipation', title: '便秘', description: '' },\n              { id: 'diarrhea', title: '腹瀉', description: '' },\n              { id: 'blood_stool', title: '血便', description: '' },\n              { id: 'irregular', title: '不規律', description: '' }\n            ]\n          },\n          {\n            id: 'excretion_timing',\n            title: '排泄時間',\n            options: [\n              { id: 'normal_timing', title: '正常時間', description: '' },\n              { id: 'frequent', title: '頻繁', description: '' },\n              { id: 'infrequent', title: '稀少', description: '' },\n              { id: 'nocturnal', title: '夜間頻繁', description: '' }\n            ]\n          }\n        ]\n      }\n    };\n    \n    return defaultOptions[symptomId] || { dimensions: [] };\n  };\n\n  const getDefaultSubOptions = (symptomId, parentOption) => {\n    const defaultSubOptions = {\n      pain: {\n        mild_pain: [\n          { id: 'dull_pain', title: '鈍痛', description: '持續性的鈍痛，疼痛性質較為溫和，可以忍受' },\n          { id: 'aching_pain', title: '隱痛', description: '深層的隱痛，疼痛位置不明確，可能為內臟痛' },\n          { id: 'soreness', title: '酸痛', description: '肌肉酸痛感，可能因手術後活動減少造成' }\n        ],\n        moderate_pain: [\n          { id: 'throbbing_pain', title: '跳痛', description: '有節奏的跳痛，可能與心跳同步，疼痛強度會變化' },\n          { id: 'distending_pain', title: '脹痛', description: '脹脹的疼痛感，可能因局部腫脹或壓力造成' },\n          { id: 'burning_pain', title: '灼痛', description: '火燒般的疼痛，可能因神經受損或炎症造成' }\n        ],\n        severe_pain: [\n          { id: 'sharp_pain', title: '刺痛', description: '尖銳的刺痛，疼痛強度很高，難以忍受' },\n          { id: 'tearing_pain', title: '撕裂痛', description: '如撕裂般的劇烈疼痛，需要立即醫療處理' },\n          { id: 'cramping_pain', title: '痙攣痛', description: '間歇性的痙攣痛，疼痛強度會突然變化' }\n        ],\n        localized_pain: [\n          { id: 'incision_pain', title: '切口疼痛', description: '手術切口部位的疼痛，可能因縫線或癒合過程造成' },\n          { id: 'tooth_pain', title: '牙齒疼痛', description: '牙齒或牙齦的疼痛，可能因手術影響口腔' },\n          { id: 'throat_pain', title: '喉嚨疼痛', description: '喉嚨部位的疼痛，可能因插管或手術影響' }\n        ],\n        radiating_pain: [\n          { id: 'head_radiation', title: '向頭部放射', description: '疼痛向頭部放射，可能因神經受壓或炎症' },\n          { id: 'neck_radiation', title: '向頸部放射', description: '疼痛向頸部放射，可能影響轉頭和活動' },\n          { id: 'shoulder_radiation', title: '向肩部放射', description: '疼痛向肩部放射，可能影響上肢活動' }\n        ],\n        intermittent_pain: [\n          { id: 'activity_related', title: '活動相關', description: '疼痛與特定活動相關，如說話、進食、轉頭等' },\n          { id: 'position_related', title: '姿勢相關', description: '疼痛與身體姿勢相關，改變姿勢可緩解' },\n          { id: 'time_related', title: '時間相關', description: '疼痛在特定時間加重，如夜間或進食後' }\n        ]\n      },\n      sleep: {\n        difficulty_falling: [\n          { id: 'pain_insomnia', title: '疼痛失眠', description: '因手術部位疼痛而無法入睡，需要止痛藥物' },\n          { id: 'anxiety_insomnia', title: '焦慮失眠', description: '因手術後焦慮和擔心而無法放鬆入睡' },\n          { id: 'environment_insomnia', title: '環境失眠', description: '因醫院環境、噪音或光線而無法入睡' }\n        ],\n        frequent_waking: [\n          { id: 'pain_waking', title: '疼痛醒來', description: '因疼痛而夜間醒來，需要調整姿勢或服藥' },\n          { id: 'breathing_waking', title: '呼吸問題醒來', description: '因呼吸困難或鼻塞而夜間醒來' },\n          { id: 'urination_waking', title: '夜尿頻繁', description: '因夜間頻繁排尿而影響睡眠連續性' }\n        ],\n        early_waking: [\n          { id: 'early_awake', title: '早醒', description: '比平時早醒，無法再入睡' },\n          { id: 'light_sleep_early', title: '淺眠早醒', description: '睡眠很淺，容易早醒' },\n          { id: 'anxiety_early', title: '焦慮早醒', description: '因焦慮而早醒，無法繼續睡眠' }\n        ],\n\n        less_than_4: [\n          { id: 'severe_insomnia', title: '嚴重失眠', description: '每晚睡眠少於4小時，嚴重影響日間功能' },\n          { id: 'pain_short_sleep', title: '疼痛影響', description: '因疼痛而無法長時間睡眠' },\n          { id: 'anxiety_short_sleep', title: '焦慮影響', description: '因焦慮而無法長時間睡眠' }\n        ],\n        '4_to_6': [\n          { id: 'moderate_insomnia', title: '中度失眠', description: '每晚睡眠4-6小時，略顯不足' },\n          { id: 'partial_rest', title: '部分休息', description: '睡眠時間勉強夠用，但品質不佳' },\n          { id: 'interrupted_sleep', title: '間斷睡眠', description: '睡眠時間被多次打斷' }\n        ],\n        '6_to_8': [\n          { id: 'adequate_sleep', title: '充足睡眠', description: '每晚睡眠6-8小時，基本充足' },\n          { id: 'normal_duration', title: '正常時長', description: '睡眠時間在正常範圍內' },\n          { id: 'good_quality', title: '品質良好', description: '睡眠時間充足且品質良好' }\n        ],\n        more_than_8: [\n          { id: 'excessive_sleep', title: '過度睡眠', description: '每晚睡眠超過8小時，可能因疲勞或藥物' },\n          { id: 'recovery_sleep', title: '恢復睡眠', description: '因手術後需要更多休息時間' },\n          { id: 'medication_sleep', title: '藥物影響', description: '因藥物作用而睡眠時間延長' }\n        ],\n        pain: [\n          { id: 'surgical_pain', title: '手術疼痛', description: '手術部位疼痛影響睡眠' },\n          { id: 'position_pain', title: '姿勢疼痛', description: '因疼痛而無法找到舒適睡眠姿勢' },\n          { id: 'medication_pain', title: '藥物依賴', description: '需要止痛藥物才能入睡' }\n        ],\n        anxiety: [\n          { id: 'surgery_worry', title: '手術擔心', description: '因擔心手術結果而焦慮' },\n          { id: 'future_worry', title: '未來擔心', description: '因擔心未來治療而無法放鬆' },\n          { id: 'stress_sleep', title: '壓力失眠', description: '因手術後各種壓力而無法放鬆' }\n        ],\n        environment: [\n          { id: 'hospital_noise', title: '醫院噪音', description: '醫院環境噪音影響睡眠' },\n          { id: 'bright_light', title: '光線過亮', description: '病房光線過亮影響睡眠' },\n          { id: 'uncomfortable_bed', title: '床鋪不適', description: '病床不舒適影響睡眠' }\n        ],\n        breathing: [\n          { id: 'nasal_obstruction', title: '鼻塞', description: '因手術後鼻塞而影響呼吸' },\n          { id: 'throat_discomfort', title: '喉嚨不適', description: '因喉嚨不適而影響呼吸' },\n          { id: 'shortness_breath', title: '呼吸困難', description: '因呼吸困難而無法安睡' }\n        ]\n      },\n      tube: {\n        normal_condition: [\n          { id: 'removal_question', title: '移除時間', description: '想了解何時可以安全移除管路' },\n          { id: 'care_instruction', title: '護理指導', description: '需要詳細的管路護理指導和注意事項' },\n          { id: 'comfort_improvement', title: '舒適改善', description: '希望改善管路舒適度，減少異物感' }\n        ],\n        mild_discomfort: [\n          { id: 'tight_fixation', title: '固定過緊', description: '管路固定過緊造成局部壓迫和不適' },\n          { id: 'foreign_body', title: '異物感', description: '明顯感覺到管路的存在，有異物感' },\n          { id: 'mild_pressure', title: '輕微壓迫', description: '管路造成輕微壓迫感，但不影響功能' }\n        ],\n        serious_issue: [\n          { id: 'bleeding', title: '滲血', description: '管路周圍有滲血，需要立即處理' },\n          { id: 'infection', title: '感染徵象', description: '管路周圍有紅腫、發熱等感染徵象' },\n          { id: 'displacement', title: '管路移位', description: '管路位置發生改變，可能影響功能' }\n        ],\n        irritation: [\n          { id: 'skin_redness', title: '皮膚發紅', description: '管路周圍皮膚發紅，可能有過敏反應' },\n          { id: 'itching', title: '瘙癢', description: '管路周圍皮膚瘙癢，可能因摩擦或過敏' },\n          { id: 'rash', title: '皮疹', description: '管路周圍出現皮疹，需要皮膚科評估' }\n        ],\n        pressure_discomfort: [\n          { id: 'circulation_issue', title: '循環問題', description: '管路壓迫影響局部血液循環' },\n          { id: 'swelling', title: '腫脹', description: '管路周圍出現腫脹，可能因壓迫造成' },\n          { id: 'numbness', title: '麻木', description: '管路周圍出現麻木感，可能因神經受壓' }\n        ],\n        movement_restriction: [\n          { id: 'speaking_difficulty', title: '說話困難', description: '管路影響說話功能，發音不清' },\n          { id: 'eating_difficulty', title: '進食困難', description: '管路影響進食功能，咀嚼或吞嚥困難' },\n          { id: 'head_movement', title: '頭部活動受限', description: '管路影響頭部轉動等活動' }\n        ]\n      },\n      excretion: {\n        urination_issue: [\n          { id: 'difficulty_urinating', title: '排尿困難', description: '無法正常排尿，需要用力或等待' },\n          { id: 'incontinence', title: '尿失禁', description: '無法控制排尿，可能因手術影響神經' },\n          { id: 'frequency_change', title: '頻率改變', description: '排尿頻率異常，可能增加或減少' }\n        ],\n        bowel_issue: [\n          { id: 'constipation', title: '便秘', description: '排便困難或次數減少，可能因藥物或活動減少' },\n          { id: 'diarrhea', title: '腹瀉', description: '頻繁的稀便，可能因藥物或感染造成' },\n          { id: 'blood_stool', title: '血便', description: '大便中帶血，需要立即就醫檢查' }\n        ],\n        no_issue: [\n          { id: 'normal_function', title: '功能正常', description: '大小便功能完全正常，無異常症狀' },\n          { id: 'slight_change', title: '輕微變化', description: '有輕微的變化但無大礙，屬於正常範圍' },\n          { id: 'monitoring', title: '持續觀察', description: '需要持續觀察變化，目前無明顯異常' }\n        ],\n        frequency_change: [\n          { id: 'increased_frequency', title: '頻率增加', description: '排尿或排便頻率明顯增加' },\n          { id: 'decreased_frequency', title: '頻率減少', description: '排尿或排便頻率明顯減少' },\n          { id: 'irregular_pattern', title: '不規律', description: '排尿或排便模式不規律，無法預測' }\n        ],\n        incontinence: [\n          { id: 'urinary_incontinence', title: '尿失禁', description: '無法控制排尿，可能因手術影響' },\n          { id: 'fecal_incontinence', title: '大便失禁', description: '無法控制排便，可能因手術影響' },\n          { id: 'mixed_incontinence', title: '混合失禁', description: '同時存在尿失禁和大便失禁' }\n        ],\n        blood_in_stool: [\n          { id: 'blood_urine', title: '血尿', description: '小便中帶血，需要立即就醫檢查' },\n          { id: 'blood_stool_only', title: '血便', description: '大便中帶血，需要立即就醫檢查' },\n          { id: 'both_blood', title: '血尿血便', description: '同時存在血尿和血便，需要緊急就醫' }\n        ]\n      }\n    };\n    \n    return defaultSubOptions[symptomId]?.[parentOption] || [];\n  };\n\n  const handleSymptomSelect = useCallback(async (symptomId) => {\n    setSelectedSymptom(symptomId);\n    setShowAiSummary(false);\n    setSelectedOption(null);\n    setSelectedSubOption(null);\n    setSubOptions([]);\n    setCurrentStep(1);\n    setError({ message: '', isServiceUnavailable: false });\n    \n    // 初始化多維度評估\n    const symptomData = getDefaultOptions(symptomId);\n    setDimensionData(symptomData);\n    setDimensionSelections({});\n  }, []);\n\n  const handleDimensionSelect = useCallback((dimensionId, optionId) => {\n    setDimensionSelections(prev => ({\n      ...prev,\n      [dimensionId]: optionId\n    }));\n  }, []);\n\n  const handleOptionSelect = useCallback(async (optionId) => {\n    setSelectedOption(optionId);\n    setCurrentStep(2);\n    setError({ message: '', isServiceUnavailable: false });\n    \n    // 調用AI API獲取第二層選項\n    await fetchAiOptions(selectedSymptom, true, optionId, 2);\n  }, [fetchAiOptions, selectedSymptom]);\n\n  const handleSubOptionSelect = useCallback(async (subOptionId) => {\n    setSelectedSubOption(subOptionId);\n    setError({ message: '', isServiceUnavailable: false });\n    \n    // 設置當前步驟為3並調用API\n    setCurrentStep(3);\n    await fetchAiOptions(selectedSymptom, true, subOptionId, 3);\n  }, [fetchAiOptions, selectedSymptom]);\n\n  const handleDetailedOptionSelect = useCallback((detailedOptionId) => {\n    setSelectedDetailedOption(detailedOptionId);\n    setShowAiSummary(true);\n  }, []);\n\n  const handleBack = useCallback(() => {\n    if (currentStep === 3) {\n      // 回到第二層\n      setCurrentStep(2);\n      setSelectedDetailedOption(null);\n      setDetailedOptions([]);\n      setShowAiSummary(false);\n    } else if (currentStep === 2) {\n      // 回到第一層\n      setCurrentStep(1);\n      setSelectedSubOption(null);\n      setSubOptions([]);\n      setShowAiSummary(false);\n    } else {\n      // 回到主選單\n      setSelectedSymptom(null);\n      setShowAiSummary(false);\n      setAiOptions([]);\n      setSelectedOption(null);\n      setSelectedSubOption(null);\n      setSubOptions([]);\n      setSelectedDetailedOption(null);\n      setDetailedOptions([]);\n      setCurrentStep(1);\n      setLoading(false);\n      setError({ message: '', isServiceUnavailable: false });\n      setApiCallCount(0); // 重置API調用計數器\n      setDimensionSelections({});\n      setDimensionData(null);\n    }\n  }, [currentStep]);\n\n  const handleReset = useCallback(() => {\n    setSelectedSymptom(null);\n    setShowAiSummary(false);\n    setAiOptions([]);\n    setSelectedOption(null);\n    setSelectedSubOption(null);\n    setSubOptions([]);\n    setSelectedDetailedOption(null);\n    setDetailedOptions([]);\n    setCurrentStep(1);\n    setLoading(false);\n    setError({ message: '', isServiceUnavailable: false });\n    setApiCallCount(0); // 重置API調用計數器\n    setDimensionSelections({});\n    setDimensionData(null);\n  }, []);\n\n  // 添加防抖機制，避免快速點擊\n  const debouncedSymptomSelect = useCallback(async (symptomId) => {\n    if (isProcessing) return;\n    setIsProcessing(true);\n    await handleSymptomSelect(symptomId);\n    setIsProcessing(false);\n  }, [handleSymptomSelect, isProcessing]);\n\n\n\n  const renderAiOptions = () => {\n    if (loading) {\n      return (\n        <LoadingContainer>\n          <LoadingSpinner />\n          <LoadingText>\n            {currentStep === 1 ? '載入標準化評估選項...' : 'AI正在根據您的評估結果生成深入問題...'}\n          </LoadingText>\n          <LoadingDots>\n            <Dot delay={0} />\n            <Dot delay={0.2} />\n            <Dot delay={0.4} />\n          </LoadingDots>\n          {apiCallCount > 0 && currentStep === 2 && (\n            <div style={{ marginTop: '10px', fontSize: '0.9rem', color: '#666' }}>\n              AI分析次數: {apiCallCount}/10\n            </div>\n          )}\n        </LoadingContainer>\n      );\n    }\n\n    if (error && error.message) {\n      return (\n        <ErrorContainer>\n          <ErrorMessage isServiceUnavailable={error.isServiceUnavailable}>載入失敗: {error.message}</ErrorMessage>\n          {apiCallCount >= 10 && (\n            <div style={{ \n              background: '#fff3cd', \n              border: '1px solid #ffeaa7', \n              padding: '10px', \n              borderRadius: '5px', \n              marginTop: '10px',\n              fontSize: '0.9rem',\n              color: '#856404'\n            }}>\n              已達到API調用限制，使用預設選項\n            </div>\n          )}\n          <RetryButton onClick={() => fetchAiOptions(selectedSymptom, currentStep === 2, selectedOption)}>\n            重試\n          </RetryButton>\n        </ErrorContainer>\n      );\n    }\n\n    // 第一層：多維度評估\n    if (currentStep === 1 && dimensionData) {\n      const currentDimensions = dimensionData.dimensions;\n      \n      return (\n        <AiOptionsContainer>\n          <ProgressIndicator>\n            <ProgressStep active={currentStep >= 1} />\n            <ProgressText active={currentStep >= 1}>多維度評估</ProgressText>\n            <ProgressStep active={currentStep >= 2} />\n            <ProgressText active={currentStep >= 2}>AI精細分析</ProgressText>\n          </ProgressIndicator>\n          \n          <h2 style={{ marginBottom: '30px', textAlign: 'center', color: '#2c3e50' }}>\n            請完成以下評估項目\n          </h2>\n          \n          <div style={{ display: 'flex', flexDirection: 'column', gap: '25px' }}>\n            {currentDimensions.map((dimension, dimensionIndex) => (\n              <div key={dimension.id} style={{ \n                border: '1px solid #e0e0e0', \n                borderRadius: '10px', \n                padding: '20px',\n                background: '#fafafa'\n              }}>\n                <h3 style={{ \n                  marginBottom: '15px', \n                  color: '#2c3e50', \n                  fontSize: '1.2rem',\n                  fontWeight: '600'\n                }}>\n                  {dimension.title}\n                </h3>\n                \n                {/* VAS疼痛量表 */}\n                {selectedSymptom === 'pain' && dimension.id === 'pain_level' && (\n                  <div style={{ marginBottom: '15px' }}>\n                    <div style={{ \n                      display: 'flex', \n                      justifyContent: 'space-between', \n                      alignItems: 'center',\n                      marginBottom: '15px'\n                    }}>\n                      <span style={{ fontSize: '0.9rem', color: '#666' }}>VAS疼痛量表：</span>\n                      <span style={{ \n                        fontSize: '1.1rem', \n                        fontWeight: 'bold', \n                        color: '#667eea',\n                        minWidth: '40px',\n                        textAlign: 'center'\n                      }}>\n                        {dimensionSelections[dimension.id] || '0'}/10\n                      </span>\n                    </div>\n                    \n                    {/* VAS滑動條 */}\n                    <div \n                      style={{ \n                        position: 'relative',\n                        background: 'linear-gradient(to right, #4caf50, #ff9800, #f44336)',\n                        height: '8px',\n                        borderRadius: '4px',\n                        marginBottom: '10px',\n                        cursor: 'pointer'\n                      }}\n                      onClick={(e) => {\n                        const rect = e.currentTarget.getBoundingClientRect();\n                        const x = e.clientX - rect.left;\n                        const percentage = Math.max(0, Math.min(1, x / rect.width));\n                        const score = Math.round(percentage * 10);\n                        handleDimensionSelect(dimension.id, score.toString());\n                      }}\n                    >\n                      <div\n                        style={{\n                          position: 'absolute',\n                          top: '-4px',\n                          left: `${((parseInt(dimensionSelections[dimension.id] || 0) / 10) * 100)}%`,\n                          width: '16px',\n                          height: '16px',\n                          borderRadius: '50%',\n                          background: '#667eea',\n                          border: '2px solid #fff',\n                          boxShadow: '0 2px 4px rgba(0,0,0,0.2)',\n                          pointerEvents: 'none',\n                          transform: 'translateX(-50%)'\n                        }}\n                      />\n                    </div>\n                    \n                    {/* 標籤 */}\n                    <div style={{ \n                      display: 'flex', \n                      justifyContent: 'space-between',\n                      fontSize: '0.75rem',\n                      color: '#666',\n                      marginTop: '5px'\n                    }}>\n                      <span>無痛</span>\n                      <span>最痛</span>\n                    </div>\n                  </div>\n                )}\n                \n                {/* 一般選項 - 兩欄顯示 */}\n                {dimension.options.length > 0 && (\n                  <div style={{ \n                    display: 'grid', \n                    gridTemplateColumns: 'repeat(2, 1fr)', \n                    gap: '10px',\n                    marginTop: '10px'\n                  }}>\n                    {dimension.options.map((option, optionIndex) => (\n                      <div\n                        key={option.id}\n                        onClick={() => handleDimensionSelect(dimension.id, option.id)}\n                        style={{\n                          padding: '10px 12px',\n                          borderRadius: '8px',\n                          border: '2px solid',\n                          borderColor: dimensionSelections[dimension.id] === option.id ? '#667eea' : '#e0e0e0',\n                          background: dimensionSelections[dimension.id] === option.id ? '#667eea' : '#fff',\n                          color: dimensionSelections[dimension.id] === option.id ? '#fff' : '#2c3e50',\n                          cursor: 'pointer',\n                          transition: 'all 0.2s ease',\n                          display: 'flex',\n                          flexDirection: 'column',\n                          gap: '3px',\n                          minHeight: '60px',\n                          justifyContent: 'center'\n                        }}\n                      >\n                        <div style={{ \n                          fontWeight: '600',\n                          fontSize: '0.9rem',\n                          textAlign: 'center'\n                        }}>\n                          {option.title}\n                        </div>\n                        {option.description && (\n                          <div style={{ \n                            fontSize: '0.75rem',\n                            opacity: dimensionSelections[dimension.id] === option.id ? '0.9' : '0.7',\n                            textAlign: 'center'\n                          }}>\n                            {option.description}\n                          </div>\n                        )}\n                      </div>\n                    ))}\n                  </div>\n                )}\n              </div>\n            ))}\n          </div>\n          \n          {/* 完成按鈕 */}\n          {Object.keys(dimensionSelections).length === currentDimensions.length && (\n            <div style={{ \n              marginTop: '30px', \n              textAlign: 'center',\n              padding: '20px',\n              background: '#e8f5e8',\n              borderRadius: '10px',\n              border: '1px solid #4caf50'\n            }}>\n              <p style={{ \n                margin: '0 0 15px 0', \n                color: '#2e7d32',\n                fontWeight: '600'\n              }}>\n                ✅ 所有評估項目已完成\n              </p>\n              <ActionButton \n                primary \n                onClick={async () => {\n                  setCurrentStep(2);\n                  setLoading(true);\n                  // 調用AI API生成初步主訴\n                  await fetchAiOptions(selectedSymptom, true, 'combined', 2);\n                }}\n              >\n                繼續進行初步主訴\n              </ActionButton>\n            </div>\n          )}\n        </AiOptionsContainer>\n      );\n    }\n\n    // 第二層或第三層：AI主訴分析\n    let options, selectedId, onOptionSelect, stepTitle;\n    \n    if (currentStep === 2) {\n      // 第二層：初步主訴\n      options = subOptions;\n      selectedId = selectedSubOption;\n      onOptionSelect = handleSubOptionSelect;\n      stepTitle = 'AI正在模擬病人的初步主訴...';\n    } else if (currentStep === 3) {\n      // 第三層：詳細主訴\n      options = detailedOptions;\n      selectedId = selectedDetailedOption;\n      onOptionSelect = handleDetailedOptionSelect;\n      stepTitle = 'AI正在生成更詳細的主訴描述...';\n    }\n\n    if (options.length === 0) {\n      return (\n        <ErrorContainer>\n          <ErrorMessage>無法載入選項</ErrorMessage>\n        </ErrorContainer>\n      );\n    }\n\n    return (\n      <AiOptionsContainer>\n        <ProgressIndicator>\n          <ProgressStep active={currentStep >= 1} />\n          <ProgressText active={currentStep >= 1}>多維度評估</ProgressText>\n          <ProgressStep active={currentStep >= 2} />\n          <ProgressText active={currentStep >= 2}>初步主訴</ProgressText>\n          <ProgressStep active={currentStep >= 3} />\n          <ProgressText active={currentStep >= 3}>詳細主訴</ProgressText>\n        </ProgressIndicator>\n        \n        <h2 style={{ marginBottom: '30px', textAlign: 'center', color: '#2c3e50' }}>\n          {stepTitle}\n        </h2>\n        \n        {apiCallCount > 0 && (currentStep === 2 || currentStep === 3) && (\n          <div style={{ \n            background: '#e3f2fd', \n            border: '1px solid #bbdefb', \n            padding: '8px 12px', \n            borderRadius: '5px', \n            marginBottom: '15px',\n            fontSize: '0.8rem',\n            color: '#1976d2',\n            textAlign: 'center'\n          }}>\n            AI分析次數: {apiCallCount}/10 {apiCallCount >= 8 && '(接近限制)'}\n          </div>\n        )}\n        \n        <div style={{ display: 'flex', flexDirection: 'column', gap: '15px' }}>\n          {options.map((option, index) => (\n            <OptionCard\n              key={option.id}\n              selected={selectedId === option.id}\n              onClick={() => onOptionSelect(option.id)}\n              delay={index * 0.1}\n            >\n              <OptionTitle>{option.title}</OptionTitle>\n              <OptionDescription>{option.description}</OptionDescription>\n            </OptionCard>\n          ))}\n        </div>\n      </AiOptionsContainer>\n    );\n  };\n\n  const renderAiSummary = () => {\n    const selectedSubOptionData = subOptions.find(option => option.id === selectedSubOption);\n    const selectedDetailedOptionData = detailedOptions.find(option => option.id === selectedDetailedOption);\n    const symptomName = symptoms.find(s => s.id === selectedSymptom)?.title;\n    \n    return (\n      <SummaryContainer>\n        <h3 style={{ textAlign: 'center', marginBottom: '20px', color: '#2c3e50' }}>\n          {symptomName}評估總結\n        </h3>\n        \n        {/* 顯示多維度評估結果 */}\n        {dimensionData && Object.keys(dimensionSelections).length > 0 && (\n          <div style={{ marginBottom: '20px' }}>\n            <h4 style={{ color: '#2c3e50', marginBottom: '15px' }}>多維度評估結果：</h4>\n            {dimensionData.dimensions.map((dimension, index) => {\n              const selectedOptionId = dimensionSelections[dimension.id];\n              const selectedOption = dimension.options.find(opt => opt.id === selectedOptionId);\n              \n              // 跳過疼痛程度的分數顯示，只顯示其他維度\n              if (selectedSymptom === 'pain' && dimension.id === 'pain_level') {\n                return null;\n              }\n              \n              return (\n                <SummaryItem key={dimension.id}>\n                  <SummaryLabel>{dimension.title}：</SummaryLabel>\n                  <SummaryValue>\n                    {selectedOption?.title || '未選擇'}\n                  </SummaryValue>\n                </SummaryItem>\n              );\n            })}\n          </div>\n        )}\n        \n        {selectedSubOptionData && (\n          <div style={{ marginTop: '20px' }}>\n            <h4 style={{ color: '#2c3e50', marginBottom: '15px' }}>初步主訴：</h4>\n            <SummaryItem>\n              <SummaryLabel>主訴：</SummaryLabel>\n              <SummaryValue>{selectedSubOptionData.title}</SummaryValue>\n            </SummaryItem>\n            <SummaryItem>\n              <SummaryLabel>詳細描述：</SummaryLabel>\n              <SummaryValue>{selectedSubOptionData.description}</SummaryValue>\n            </SummaryItem>\n          </div>\n        )}\n        \n        {selectedDetailedOptionData && (\n          <div style={{ marginTop: '20px' }}>\n            <h4 style={{ color: '#2c3e50', marginBottom: '15px' }}>詳細主訴：</h4>\n            <SummaryItem>\n              <SummaryLabel>主訴：</SummaryLabel>\n              <SummaryValue>{selectedDetailedOptionData.title}</SummaryValue>\n            </SummaryItem>\n            <SummaryItem>\n              <SummaryLabel>詳細描述：</SummaryLabel>\n              <SummaryValue>{selectedDetailedOptionData.description}</SummaryValue>\n            </SummaryItem>\n          </div>\n        )}\n        \n        <div style={{ marginTop: '20px', textAlign: 'center' }}>\n          <ActionButton onClick={() => {\n            setShowAiSummary(false);\n            if (selectedDetailedOptionData) {\n              setSelectedDetailedOption(null);\n              setDetailedOptions([]);\n              setCurrentStep(3);\n            } else {\n              setSelectedSubOption(null);\n              setCurrentStep(2);\n            }\n          }}>\n            重新選擇主訴\n          </ActionButton>\n        </div>\n      </SummaryContainer>\n    );\n  };\n\n  return (\n    <AppContainer>\n      <ApiKeySetup />\n      <Header>\n        <Title>術後主訴表達系統</Title>\n        <Subtitle>請選擇您目前的主要不適症狀</Subtitle>\n      </Header>\n\n      <ContentCard>\n        <StepIndicator>\n          <Step active={!selectedSymptom}>選擇主訴</Step>\n          <Step active={selectedSymptom && !showAiSummary}>評估中</Step>\n          <Step active={showAiSummary}>完成</Step>\n        </StepIndicator>\n\n        {!selectedSymptom && (\n          <>\n            <h2 style={{ marginBottom: '30px', color: '#2c3e50', textAlign: 'center', fontSize: '1.8rem' }}>\n              請選擇您目前的主要主訴\n            </h2>\n            <SymptomGrid>\n              {symptoms.map((symptom, index) => {\n                const IconComponent = symptom.icon;\n                return (\n                  <SymptomCard\n                    key={symptom.id}\n                    onClick={() => debouncedSymptomSelect(symptom.id)}\n                    style={{ animationDelay: `${index * 0.1}s` }}\n                  >\n                    <SymptomIcon>\n                      <IconComponent size={32} />\n                    </SymptomIcon>\n                    <h3>{symptom.title}</h3>\n                    <p>{symptom.description}</p>\n                  </SymptomCard>\n                );\n              })}\n            </SymptomGrid>\n          </>\n        )}\n\n        {selectedSymptom && (\n          <>\n            <NavigationBar>\n              <NavButton onClick={handleBack}>\n                <ArrowLeft size={18} />\n                {currentStep === 2 ? '返回上一步' : '返回選擇主訴'}\n              </NavButton>\n              <NavButton onClick={handleReset}>\n                <Home size={18} />\n                重新開始\n              </NavButton>\n            </NavigationBar>\n\n            <h2 style={{ marginBottom: '20px', color: '#2c3e50', textAlign: 'center', fontSize: '1.8rem' }}>\n              {symptoms.find(s => s.id === selectedSymptom)?.title}評估\n            </h2>\n            \n            {!showAiSummary && renderAiOptions()}\n            \n            {showAiSummary && renderAiSummary()}\n\n            <ButtonContainer>\n              <ActionButton onClick={handleBack}>\n                {currentStep === 2 ? '返回上一步' : '返回選擇主訴'}\n              </ActionButton>\n              {showAiSummary && (\n                <ActionButton primary onClick={handleReset}>\n                  完成並重新開始\n                </ActionButton>\n              )}\n            </ButtonContainer>\n          </>\n        )}\n      </ContentCard>\n    </AppContainer>\n  );\n}\n\nexport default App; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}